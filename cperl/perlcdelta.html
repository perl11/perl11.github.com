<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>perlcdelta - what is new for cperl v5.30.0</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:rurban@cpan.org" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#Core-Enhancements">Core Enhancements</a>
    <ul>
      <li><a href="#Check-bless-name-under-use-strict-names">Check bless name under use strict names</a></li>
      <li><a href="#New-warning-shadow-package">New warning shadow package</a></li>
      <li><a href="#extern-sub---libffi">extern sub - libffi</a></li>
      <li><a href="#Wildcards-in-Unicode-property-value-specifications-are-now-partially-supported">Wildcards in Unicode property value specifications are now partially supported</a></li>
      <li><a href="#qr-N-name-is-now-supported">qr&#39;\N{name}&#39; is now supported</a></li>
      <li><a href="#Unicode-12.1-is-supported">Unicode 12.1 is supported</a></li>
      <li><a href="#Handle-qr-p-nv-6-8">Handle qr!\p{nv=6/8}!</a></li>
      <li><a href="#The-upper-limit-n-specifiable-in-a-regular-expression-quantifier-of-the-form-m-n-has-been-doubled-to-65534">The upper limit &quot;n&quot; specifiable in a regular expression quantifier of the form &quot;{m,n}&quot; has been doubled to 65534</a></li>
      <li><a href="#Drv-now-means-something-on--DDEBUGGING-builds">-Drv now means something on -DDEBUGGING builds</a></li>
      <li><a href="#Eliminated-optree-recursion">Eliminated optree recursion</a></li>
      <li><a href="#Turkic-UTF-8-locales-are-now-seamlessly-supported">Turkic UTF-8 locales are now seamlessly supported</a></li>
      <li><a href="#It-is-now-possible-to-compile-perl-to-always-use-thread-safe-locale-operations">It is now possible to compile perl to always use thread-safe locale operations.</a></li>
    </ul>
  </li>
  <li><a href="#Security">Security</a>
    <ul>
      <li><a href="#Variable-length-lookbehind-in-regular-expression-pattern-matching-is-now-experimentally-supported">Variable length lookbehind in regular expression pattern matching is now experimentally supported</a></li>
      <li><a href="#Disallowed-Limited-Use-Scripts">Disallowed Limited Use Scripts</a></li>
      <li><a href="#CVE-2018-18311-Integer-overflow-leading-to-buffer-overflow-and-segmentation-fault">[CVE-2018-18311] Integer overflow leading to buffer overflow and segmentation fault</a></li>
      <li><a href="#Restrict-my_setenv-to-ARG_MAX">Restrict my_setenv to ARG_MAX</a></li>
    </ul>
  </li>
  <li><a href="#Incompatible-Changes">Incompatible Changes</a>
    <ul>
      <li><a href="#Protected-hash-iterators">Protected hash iterators</a></li>
      <li><a href="#Assigning-non-zero-to-is-fatal">Assigning non-zero to $[ is fatal</a></li>
      <li><a href="#Previously-deprecated-sysread-syswrite-on-:utf8-handles-now-fatal">Previously deprecated sysread()/syswrite() on :utf8 handles now fatal</a></li>
      <li><a href="#my-in-false-conditional-prohibited">my() in false conditional prohibited</a></li>
      <li><a href="#Fatalize-and">Fatalize $* and $#</a></li>
      <li><a href="#Fatalize-unqualified-use-of-dump">Fatalize unqualified use of dump()</a></li>
      <li><a href="#Remove-File::Glob::glob">Remove File::Glob::glob()</a></li>
      <li><a href="#pack-no-longer-can-return-malformed-UTF-8">pack() no longer can return malformed UTF-8</a></li>
      <li><a href="#Any-set-of-digits-in-the-Common-script-are-legal-in-a-script-run-of-another-script">Any set of digits in the Common script are legal in a script run of another script</a></li>
    </ul>
  </li>
  <li><a href="#Deprecations">Deprecations</a>
    <ul>
      <li><a href="#Undeprecate-Unescaped-left-brace-in-regex-warnings-and-errors">Undeprecate &quot;Unescaped left brace in regex&quot; warnings and errors</a></li>
      <li><a href="#Remove-support-for-qr-p-_Case_Ignorable">Remove support for qr/\p{_Case_Ignorable}</a></li>
      <li><a href="#Remove-support-for-qr-p-_Comb_Above">Remove support for qr/\p{_Comb_Above}</a></li>
      <li><a href="#Remove-support-for-qr-p-_CanonDCIJ">Remove support for qr/\p{_CanonDCIJ}</a></li>
    </ul>
  </li>
  <li><a href="#Performance-Enhancements">Performance Enhancements</a></li>
  <li><a href="#Modules-and-Pragmata">Modules and Pragmata</a>
    <ul>
      <li><a href="#New-Modules-and-Pragmata">New Modules and Pragmata</a></li>
      <li><a href="#Updated-Modules-and-Pragmata">Updated Modules and Pragmata</a></li>
      <li><a href="#Removed-Modules-and-Pragmata">Removed Modules and Pragmata</a></li>
    </ul>
  </li>
  <li><a href="#Documentation">Documentation</a>
    <ul>
      <li><a href="#Changes-to-Existing-Documentation">Changes to Existing Documentation</a>
        <ul>
          <li><a href="#perlfaq-5.201809151">perlfaq 5.20180915</a></li>
          <li><a href="#perlvar">perlvar</a></li>
          <li><a href="#perlhacktips">perlhacktips</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#Diagnostics">Diagnostics</a>
    <ul>
      <li><a href="#New-Diagnostics">New Diagnostics</a>
        <ul>
          <li><a href="#New-Errors">New Errors</a></li>
          <li><a href="#New-Warnings">New Warnings</a></li>
        </ul>
      </li>
      <li><a href="#Changes-to-Existing-Diagnostics">Changes to Existing Diagnostics</a></li>
    </ul>
  </li>
  <li><a href="#Configuration-and-Compilation">Configuration and Compilation</a></li>
  <li><a href="#Testing">Testing</a></li>
  <li><a href="#Platform-Support">Platform Support</a>
    <ul>
      <li><a href="#Platform-Specific-Notes">Platform-Specific Notes</a></li>
    </ul>
  </li>
  <li><a href="#Internal-Changes">Internal Changes</a></li>
  <li><a href="#Testing1">Testing</a></li>
  <li><a href="#Selected-Bug-Fixes">Selected Bug Fixes</a></li>
  <li><a href="#Known-Problems">Known Problems</a></li>
  <li><a href="#Acknowledgements">Acknowledgements</a></li>
  <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>perlcdelta - what is new for cperl v5.30.0</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This document describes differences between the cperl 5.28.2 and the cperl 5.30.0 release.</p>

<p>If you are upgrading from an earlier release such as v5.26.2c, first read <a href="/cperl/perl5280cdelta.html">perl5280cdelta</a>, which describes the differences between v5.28.0c and v5.26.2c.</p>

<h1 id="Core-Enhancements">Core Enhancements</h1>

<h2 id="Check-bless-name-under-use-strict-names">Check bless name under use strict names</h2>

<p>The second argument to bless, the new classname, is now checked to be a valid package name identifier when <b>strict &#39;names&#39;</b> is in effect, and the name is now normalized. <a href="https://github.com/perl11/cperl/issues/376">[cperl #376]</a></p>

<p>This is a bugfix, but a major compatibility change.</p>

<h2 id="New-warning-shadow-package">New warning shadow package</h2>

<p>When a subroutine with the same name of a package exists, all package methods are rerouted through this subroutine, effectively eliminating all access to the package via methods. This is almost always an error, unless you want to override access to the package or want a data-only package, without any methods. cperl added the shadow warnings <a href="/cperl/perldiag.html#Subroutine-s::-s-masks-existing-package-s::-s">&quot;Subroutine &amp;%s::%s masks existing package %s::%s&quot; in perldiag</a> and <a href="/pod/perldiag.html#Subroutine-s-masks-new-package-s">&quot;Subroutine &amp;%s masks new package %s&quot; in perldiag</a>. Use <code>no warnings &#39;shadow&#39;;</code> to silence these new warnings.</p>

<h2 id="extern-sub---libffi">extern sub - libffi</h2>

<p>A new <a>ffi</a> was added to core, with a syntax resembling perl6 NativeCall. Perl6 traits are cperl <a>attributes</a>, but attribute values may be deferred to run-time. Packagers need to add <b>libffi</b> to their library dependencies. Windows packages are provided, see <i>appveyor.yml</i>.</p>

<p>Not yet implemented are the <code>:encoded()</code> attribute for string arguments and return values, the various encoded string types Uni, wchar, c-struct helpers, native arrays and native classes (i.e. structs), callback helpers and support for variadic (varargs) functions.</p>

<h2 id="Wildcards-in-Unicode-property-value-specifications-are-now-partially-supported">Wildcards in Unicode property value specifications are now partially supported</h2>

<p>You can now do something like this in a regular expression pattern</p>

<pre><code> qr! \p{nv= /(?x) \A [0-5] \z / }!</code></pre>

<p>which matches all Unicode code points which have numeric value is between 0 and 5 inclusive.</p>

<p>This marks another step in implementing the regular expression features the Unicode Consortium suggests.</p>

<p>Most properties are supported, with the remainder planned for 5.32. Details are in <a href="/cperl/perlunicode.html#Wildcards-in-Property-Values">&quot;Wildcards in Property Values&quot; in perlunicode</a>.</p>

<h2 id="qr-N-name-is-now-supported">qr&#39;\N{name}&#39; is now supported</h2>

<p>Previously it was an error to evaluate a named character <code>\N{...}</code> within a single quoted regular expression pattern (whose evaluation is deferred from the normal place). This restriction is now removed.</p>

<h2 id="Unicode-12.1-is-supported">Unicode 12.1 is supported</h2>

<p>For details, see <a href="https://www.unicode.org/versions/Unicode12.1.0/">https://www.unicode.org/versions/Unicode12.1.0/</a>.</p>

<p>The Word_Break property, as in past Perl releases, remains tailored to behave more in line with expectations of Perl users. This means that sequential runs of horizontal white space characters are not broken apart, but kept as a single run. Unicode 11 changed from past versions to be more in line with Perl, but it left several white space characters as causing breaks: TAB, NO BREAK SPACE, and FIGURE SPACE (U+2007). We have decided to continue to use the previous Perl tailoring with regards to these.</p>

<p>As of July 2018, another aspect of Unicode 11.0 is causing problems, and that is the changing the Georgian script to have both lower and uppercase letters. It turns out that many devices do not have fonts installed that can display the new uppercase letters, and people using Georgian are finding their text more or less illegible. It is being suggested that implementations delay their adoption of this portion of 11.0. But since the next stable release of Perl is almost a year away, this aspect of 11.0 is being left in, with the option to back it out if things haven&#39;t improved by that time, or if we get too many complaints about the development release being unusable for Georgian users.</p>

<p>Because of a change in Unicode release cycles, Perl jumps from Unicode 10.0 in Perl 5.28 to Unicode 12.0 in Perl 5.30.</p>

<p>There are few new scripts: Elymaic, Nandinagari, Nyiakeng_Puachue_Hmong (Hmnp), Wancho, all of them not available for identifiers.</p>

<h2 id="Handle-qr-p-nv-6-8">Handle qr!\p{nv=6/8}!</h2>

<p>Allow a rational number specified in looking up the Numeric Value Unicode property to not be in lowest possible terms.</p>

<p>The Numeric Value property allows one to find all code points that have a certain numeric value. An example would be to match against any character in any of the world&#39;s scripts which is effectively equivalent to the digit zero.</p>

<p>We accept either integers (like <code>\p{nv=9}</code>) or rationals (like <code>\p{nv=1/2}</code>). But we also accept floating point representations in case a conversion to numeric has happened, (like <code>\p{nv=0.5}</code>). The necessary precision is now automatically pre-calculated and the lookup normalized.</p>

<h2 id="The-upper-limit-n-specifiable-in-a-regular-expression-quantifier-of-the-form-m-n-has-been-doubled-to-65534">The upper limit <code>&quot;n&quot;</code> specifiable in a regular expression quantifier of the form <code>&quot;{m,n}&quot;</code> has been doubled to 65534</h2>

<p>The upper limit <code>&quot;n&quot;</code> specifiable in a regular expression quantifier of the form <code>&quot;{m,n}&quot;</code> has also been doubled to 65534.</p>

<p>The meaning of an unbounded upper quantifier <code>&quot;{m,}&quot;</code> remains unchanged. It matches 2**31 - 1 times on most platforms, and more on ones where a C language short variable is more than 4 bytes long.</p>

<h2 id="Drv-now-means-something-on--DDEBUGGING-builds"><code>-Drv</code> now means something on <code>-DDEBUGGING</code> builds</h2>

<p>Now, adding the verbose flag (<code>-Dv</code>) to the <code>-Dr</code> flag turns on all possible regular expression debugging, as with <code>use re &#39;debug&#39;;</code>. See <a>re</a>.</p>

<h2 id="Eliminated-optree-recursion">Eliminated optree recursion</h2>

<p>Eliminated recursion from internal <code>finalize_op()</code> and <code>optimize_op()</code>, avoiding segfaults with extremely nested ops. E.g. with</p>

<pre><code>    perl -e &#39;my $line = &quot;\$cond ? \$a : \n&quot;;
             my $code = ($line x 100000) . &quot;\$b;\n&quot;;
             eval $code;&#39;</code></pre>

<p>Contrary to what is said in the relevant perldelta, your code is now slower. Before it crashed with a segfault, now it does much more. The regular case is also slower due to stack handling on the heap, similar to the regexp changes in 5.10. <a href="https://rt.perl.org/Ticket/Display.html?id=108276">[perl #108276]</a>.</p>

<h2 id="Turkic-UTF-8-locales-are-now-seamlessly-supported">Turkic UTF-8 locales are now seamlessly supported</h2>

<p>Turkic languages have different casing rules than other languages for the characters <code>&quot;i&quot;</code> and <code>&quot;I&quot;</code>. The uppercase of <code>&quot;i&quot;</code> is LATIN CAPITAL LETTER I WITH DOT ABOVE (U+0130); and the lowercase of <code>&quot;I&quot;</code> is LATIN SMALL LETTER DOTLESS I (U+0131). Unicode furnishes alternate casing rules for use with Turkic languages. Previously, Perl ignored these, but now, it uses them when it detects that it is operating under a Turkic UTF-8 locale.</p>

<h2 id="It-is-now-possible-to-compile-perl-to-always-use-thread-safe-locale-operations">It is now possible to compile perl to always use thread-safe locale operations.</h2>

<p>Previously, these calls were only used when the perl was compiled to be multi-threaded. To always enable them, add</p>

<pre><code>  -Accflags=&#39;-DUSE_THREAD_SAFE_LOCALE&#39;</code></pre>

<p>to your <i>Configure</i> flags.</p>

<h1 id="Security">Security</h1>

<h2 id="Variable-length-lookbehind-in-regular-expression-pattern-matching-is-now-experimentally-supported">Variable length lookbehind in regular expression pattern matching is now experimentally supported</h2>

<p>Using a lookbehind assertion (like <code>(?&lt;=foo)</code> or <code>(?&lt;!bar)</code> previously would generate an error and refuse to compile. Now it compiles (if the maximum lookbehind is at most 255 characters), but raises a warning in the new <code>experimental::vlb</code> warnings category. This is to caution you that the precise behavior is subject to change based on feedback from use in the field.</p>

<p>See <a href="/cperl/perlre.html#pattern">&quot;(?&lt;=pattern)&quot; in perlre</a> and <a href="/pod/perlre.html#pattern">&quot;(?&lt;!pattern)&quot; in perlre</a>.</p>

<h2 id="Disallowed-Limited-Use-Scripts">Disallowed Limited Use Scripts</h2>

<p>The list of valid scripts for identifiers was purged from all <b>Limited Use</b> scripts from <a href="http://www.unicode.org/reports/tr31/#Table_Limited_Use_Scripts">http://www.unicode.org/reports/tr31/#Table_Limited_Use_Scripts</a>. They fail now.</p>

<p>Unicode 10.0 started disallowing all Aspirational Use Scripts, but we didn&#39;t handle them at all. <i>Table 4. Candidate Characters for Exclusion from Identifiers</i> scripts are still allowed, and still need to be explicitly enabled as a <code>use utf8</code> argument. cperl-only.</p>

<h2 id="CVE-2018-18311-Integer-overflow-leading-to-buffer-overflow-and-segmentation-fault">[CVE-2018-18311] Integer overflow leading to buffer overflow and segmentation fault</h2>

<p>Integer arithmetic in <code>Perl_my_setenv()</code> could wrap when the combined length of the environment variable name and value exceeded around 0x7fffffff. This could lead to writing beyond the end of an allocated buffer with attacker supplied data.</p>

<p><a href="https://rt.perl.org/Ticket/Display.html?id=133204">[perl #133204]</a></p>

<h2 id="Restrict-my_setenv-to-ARG_MAX">Restrict my_setenv to ARG_MAX</h2>

<p>perl5 fixed <code>Perl_my_setenv()</code> by allowing <code>%ENV</code> sizes larger than <code>ARG_MAX</code> (typically 128Kb), up to 2GB. This is considered a security risk. It writes onto the kernel stack, even if often caught by MAXEXECARGS &quot;Argument list too long&quot; kernel errors on the next exec call. cperl disallows <code>%ENV</code> larger than the sysconf(_SC_ARG_MAX)/MAX_ARG_STRLEN/ ARG_MAX/NCARGS size with a new <a href="/cperl/perldiag.html#Environment-size-d-larger-than-the-allowed-d">&quot;Environment size %d larger than the allowed %d&quot; in perldiag</a> error.</p>

<h1 id="Incompatible-Changes">Incompatible Changes</h1>

<h2 id="Protected-hash-iterators">Protected hash iterators</h2>

<p>Iterating over a hash may now by default not change any key. Allow the previous destructive behavior of changing a hash while iterating over it with <code>use hashiter;</code> See <a href="https://github.com/perl11/cperl/issues/117">[cperl #117]</a>, cperl-only.</p>

<h2 id="Assigning-non-zero-to-is-fatal">Assigning non-zero to <code>$[</code> is fatal</h2>

<p>Setting <a href="/cperl/perlvar.html#pod"><code>$[</code></a> to a non-zero value has been deprecated since Perl 5.12 and now throws a fatal error. See <a href="/pod/perldeprecation.html#Assigning-non-zero-to-is-fatal">&quot;Assigning non-zero to <code>$[</code> is fatal&quot; in perldeprecation</a>.</p>

<h2 id="Previously-deprecated-sysread-syswrite-on-:utf8-handles-now-fatal">Previously deprecated sysread()/syswrite() on :utf8 handles now fatal</h2>

<p>Calling sysread(), syswrite(), send() or recv() on a <code>:utf8</code> handle, whether applied explicitly or implicitly, is now fatal. This was deprecated in perl 5.24.</p>

<p>There were two problems with calling these functions on <code>:utf8</code> handles:</p>

<ul>

<li><p>All four functions only paid attention to the <code>:utf8</code> flag. Other layers were completely ignored, so a handle with <code>:encoding(UTF-16LE)</code> layer would be treated as UTF-8. Other layers, such as compression are completely ignored with or without the <code>:utf8</code> flag.</p>

</li>
<li><p>sysread() and recv() would read from the handle, skipping any validation by the layers, and do no validation of their own. This could lead to invalidly encoded perl scalars.</p>

</li>
</ul>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=125760">[perl #125760]</a></p>

<h2 id="my-in-false-conditional-prohibited">my() in false conditional prohibited</h2>

<p>Declarations such as <code>my $x if 0</code> are no longer permitted. This feature was deprecated in 5.10 (and replaced by two better constructs, one of it backwards compatible) and is now a fatal error. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133543">[perl #133543]</a></p>

<p>Note: cperl does not agree that this feature is a bug, but this ship sailed already over a decade ago.</p>

<h2 id="Fatalize-and">Fatalize $* and $#</h2>

<p>These special variables, long deprecated, now throw an error when used. See <a href="/cperl/perldiag.html#is-no-longer-supported-as-of-Perl-5.30">&quot;$* is no longer supported as of Perl 5.30&quot; in perldiag</a> and <a href="/pod/perldiag.html#is-no-longer-supported-as-of-Perl-5.30">&quot;$# is no longer supported as of Perl 5.30&quot; in perldiag</a>. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133583">[perl #133583]</a></p>

<h2 id="Fatalize-unqualified-use-of-dump">Fatalize unqualified use of dump()</h2>

<p>The <code>dump()</code> function, long discouraged, may no longer be used unless it is fully qualified, <i>i.e.</i>, <code>CORE::dump()</code>.</p>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=133584">[perl #133584]</a></p>

<h2 id="Remove-File::Glob::glob">Remove File::Glob::glob()</h2>

<p>The <code>File::Glob::glob()</code> function, long deprecated, has been removed and now throws an exception which advises use of <code>File::Glob::bsd_glob()</code> instead.</p>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=133586">[perl #133586]</a></p>

<h2 id="pack-no-longer-can-return-malformed-UTF-8"><code>pack()</code> no longer can return malformed UTF-8</h2>

<p>It croaks if it would otherwise return a UTF-8 string that contains malformed UTF-8. This protects agains potential security threats. This is considered a bug fix as well.</p>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=131642">[perl #131642]</a></p>

<h2 id="Any-set-of-digits-in-the-Common-script-are-legal-in-a-script-run-of-another-script">Any set of digits in the Common script are legal in a script run of another script</h2>

<p>There are several sets of digits in the Common script. <code>[0-9]</code> is the most familiar. But there are also <code>[\x{FF10}-\x{FF19}]</code> (FULLWIDTH DIGIT ZERO - FULLWIDTH DIGIT NINE), and several sets for use in mathematical notation, such as the MATHEMATICAL DOUBLE-STRUCK DIGITs. Any of these sets should be able to appear in script runs of, say, Greek. But the design of 5.30 overlooked all but the ASCII digits <code>[0-9]</code>, so the design was flawed. This has been fixed, so is both a bug fix and an incompatibility. [perl #133547] <a href="https://rt.perl.org/Public/Bug/Display.html?id=133547">[perl #133547]</a></p>

<p>All digits in a run still have to come from the same set of ten digits.</p>

<h1 id="Deprecations">Deprecations</h1>

<h2 id="Undeprecate-Unescaped-left-brace-in-regex-warnings-and-errors">Undeprecate &quot;Unescaped left brace in regex&quot; warnings and errors</h2>

<p>In cperl only the following special unicode groups within regexes are reserved:</p>

<pre><code>   Name:     \N{
   Property: \p{ \P{
   Break:    \b{ \B{
   Code:     \x{ \o{
   Group:    \g{</code></pre>

<p>All other <code>/{}/</code> sequences are allowed in cperl and not deprecated anymore. There&#39;s no need to quote the literal <code>\{</code> and <code>\}</code>, only if it&#39;s ambiguous and can be mixed up with those reserved unicode groups.</p>

<p><b>automake</b> and more widespread utils does not need to be plagued by spurious &quot;Unescaped left brace in regex&quot; warnings, when they dont need to be quoted. We undeprecated those new warnings and errors, there&#39;s nothing more to reserve (yet). <a href="https://github.com/perl11/cperl/issues/362">[cperl #362]</a></p>

<h2 id="Remove-support-for-qr-p-_Case_Ignorable">Remove support for <code>qr/\p{_Case_Ignorable}</code></h2>

<p>This property is no longer used in the core, nor in cpan, and is marked as for core use only, not necessarily stable. I have kept it around because it was work to remove it, but now the revamping of the property lookup scheme was causing failures with it, when compiling on early Unicode releases. That could be fixed with extra work, but simply removing it also fixes the problem and avoids future maintenance costs.</p>

<h2 id="Remove-support-for-qr-p-_Comb_Above">Remove support for <code>qr/\p{_Comb_Above}</code></h2>

<p>This property is no longer used in the core, nor in cpan, and is marked as for core use only, not necessarily stable. I have kept it around because it was work to remove it, but now the revamping of the property lookup scheme was causing failures with a similar property, and the previous commit removed that one.</p>

<h2 id="Remove-support-for-qr-p-_CanonDCIJ">Remove support for <code>qr/\p{_CanonDCIJ}</code></h2>

<p>The property is not used in cpan, and is being removed as part of the cleanup instigated because another of the 3 would require extra code to handle if we were to keep it around.</p>

<h1 id="Performance-Enhancements">Performance Enhancements</h1>

<ul>

<li><p>Optimization of <code>IV</code> to <code>UV</code> conversions. <a href="https://rt.perl.org/Ticket/Display.html?id=133677">[perl #133677]</a>.</p>

</li>
<li><p>Speed up of the integer stringification algorithm by processing two digits at a time instead of one. <a href="https://rt.perl.org/Ticket/Display.html?id=133691">[perl #133691]</a>.</p>

</li>
<li><p>Minor improvements based on LGTM analysis and recommendation. (<a href="https://lgtm.com/projects/g/Perl/perl5/alerts/?mode=tree">https://lgtm.com/projects/g/Perl/perl5/alerts/?mode=tree</a>). <a href="https://rt.perl.org/Ticket/Display.html?id=133686">[perl #133686]</a>. <a href="https://rt.perl.org/Ticket/Display.html?id=133699">[perl #133699]</a>.</p>

</li>
<li><p>Improved Unicode numeric property lookups, for <code>\p{nv=float}</code>, in size and speed by using more pre-compiled perfect hashes instead of slow pure-perl invlist walks at run-time, esp. for all numeric properties (70 more). Also avoids more swash creations.</p>

</li>
<li><p>Translating from UTF-8 into the code point it represents now is done via a deterministic finite automaton, speeding it up. As a typical example, <code>ord(&quot;\x7fff&quot;)</code> now requires 12% fewer instructions than before. The performance of checking that a sequence of bytes is valid UTF-8 is similarly improved, again by using a dfa.</p>

</li>
<li><p>Code optimizations in <i>regcomp.c</i>, <i>regcomp.h</i>, <i>regexec.c</i>.</p>

<p>The second regcomp pass was removed.</p>

</li>
<li><p>The handling of user-defined <code>\p{}</code> properties (see <a href="/cperl/perlunicode.html#User-Defined-Character-Properties">&quot;User-Defined Character Properties&quot; in perlunicode</a>) has been rewritten to be in C (instead of Perl). This removed all uses of swashes from regular expression compilation and execution.</p>

<p>This speeds things up, but in the process several inconsistencies and bug fixes are made.</p>

<ol>

<li><p>A few error messages have minor wording changes. This is essentially because the new way is integrated into the regex error handling mechanism that marks the position in the input at which the error occurred. That was not possible previously. The messages now also contain additional back-trace-like information in case the error occurs deep in nested calls.</p>

</li>
<li><p>A user-defined property is implemented as a perl subroutine with certain highly constrained naming conventions. It was documented previously that the sub would be in the current package if the package was unspecified. This turned out not to be true in all cases, but now it is.</p>

</li>
<li><p>All recursive calls are treated as infinite recursion. Previously they would cause the interpreter to panic. Now, they cause the regex pattern to fail to compile.</p>

</li>
<li><p>Similarly, any other error likely would lead to a panic; now to just the pattern failing to compile.</p>

</li>
<li><p>The old mechanism did not detect illegal ranges in the definition of the property. Now, the range max must not be smaller than the range min. Otherwise, the pattern fails to compile.</p>

</li>
<li><p>The intention was to have each sub called only once during the lifetime of the program, so that a property&#39;s definition is immutable. This was relaxed so that it could be called once for all /i compilations, and potentially a second time for non-/i (the sub is passed a parameter indicating which). However, in practice there were instances when this was broken, and multiple calls were possible. Those have been fixed. Now (besides the /i,non-/i cases) the only way a sub can be called multiple times is if some component of it has not been defined yet. For example, suppose we have sub IsA() whose definition is known at compile time, and it in turn calls isB() whose definition is not yet known. isA() will be called each time a pattern it appears in is compiled. If isA() also calls isC() and that definition is known, isC() will be called just once.</p>

</li>
<li><p>There were some races and very long hangs should one thread be compiling the same property as another simultaneously. These have now been fixed.</p>

</li>
</ol>

</li>
<li><p>Optimized the static link order of objects for the default case, when you cannot use lto, pgo, autofdo nor bolt. Added lto to the default ccflags. See <a href="http://perl11.org/blog/bolt.html">http://perl11.org/blog/bolt.html</a> and <a href="https://github.com/perl11/cperl/issues/381">[cperl #381]</a>.</p>

</li>
<li><p>Improve newSVpvn_share</p>

<p>Don&#39;t downgrade twice, the is_utf8 flags can be taken from the returned hek, which does the downgrading to bytes already.</p>

</li>
</ul>

<h1 id="Modules-and-Pragmata">Modules and Pragmata</h1>

<p>The list of new and updated modules is modified automatically as part of preparing a Perl release, so the only reason to manually add entries here is if you&#39;re summarising the important changes in the module update. (Also, if the manually-added details don&#39;t match the automatically-generated ones, the release manager will have to investigate the situation carefully.)</p>

<h2 id="New-Modules-and-Pragmata">New Modules and Pragmata</h2>

<dl>

<dt id="ffi-0.01c"><a>ffi</a> 0.01c</dt>
<dd>

<p>ffi helpers and ffi types.</p>

</dd>
<dt id="hashiter"><a>hashiter</a></dt>
<dd>

<p>Allow hash iterators changing keys for back-compat. See <a href="#Protected-hash-iterators">&quot;Protected hash iterators&quot;</a>.</p>

</dd>
</dl>

<h2 id="Updated-Modules-and-Pragmata">Updated Modules and Pragmata</h2>

<dl>

<dt id="Archive::Tar-2.32"><a>Archive::Tar</a> 2.32</dt>
<dd>

<p>Fix absolute path handling on VMS</p>

</dd>
<dt id="attributes-1.15c"><a>attributes</a> 1.15c</dt>
<dd>

<p>Add ffi support, :native(), :encoded(), :nativeconv(), :symbol().</p>

</dd>
<dt id="B-1.76_10"><a>B</a> 1.76_10</dt>
<dd>

<p>Fixed for -DPERL_GLOBAL_STRUCT. Add ffi support: CvXFFI, CvFFLIB. CVf_EXTERN flag</p>

</dd>
<dt id="B::C-1.57_01"><a>B::C</a> 1.57_01</dt>
<dd>

<p>New major release, with dVAR support and experimental cross support and -m (module) support. Add $dynamic_copwarn needed for v5.29.7+ (not cperl).</p>

</dd>
<dt id="B::Deparse-1.49_05c"><a>B::Deparse</a> 1.49_05c</dt>
<dd>

<p>Removed arybase support.</p>

</dd>
<dt id="bignum-0.51c"><a>bignum</a> 0.51c</dt>
<dd>

<p>Better way to catch warnings (CPAN RT #126900).</p>

</dd>
<dt id="bytes-1.07"><a>bytes</a> 1.07</dt>
<dd>

<p>Typo in pod</p>

</dd>
<dt id="Config-6.23"><a>Config</a> 6.23</dt>
<dd>

<p>Add the FREEBSD_KERNEL_VERSION key for FreeBSD.</p>

</dd>
<dt id="Config::Extensions-0.03"><a>Config::Extensions</a> 0.03</dt>
<dd>

<p>Whitespace only</p>

</dd>
<dt id="CPAN-2.21_01"><a>CPAN</a> 2.21_01</dt>
<dd>

<p>Update to 2.21 upstream with our cperl fixes. Some of our fixes were accepted upstream.</p>

<p>Fixed critical rmtree bug with a symlink crossing mountpoints previous directory ~/.cpan/build changed before entering tmp-32186, expected dev=47 ino=244719549, actual dev=47 ino=33303, aborting at CPAN/Distribution.pm line 591</p>

<p>Add many upstream tests and distroprefs. Still need to install them, and add the cperl distroprefs.</p>

</dd>
<dt id="Cpanel::JSON::XS-4.12"><a>Cpanel::JSON::XS</a> 4.12</dt>
<dd>

<p>Make encoder independent on Math::BigInt version</p>

<p>Rethrow error from eval_sv and eval_pv(), e.g. when Math::BigInt/BigFloat fails.</p>

<p>Fix encoding Inf and NaN from PV and NV slots to JSON_TYPE_INT</p>

<p>Fix memory corruption in sv_to_ivuv() function</p>

<p>Add new method -&gt;require_types</p>

<p>Fix typed json encoder conversion from scalar&#39;s PV and NV slot to JSON_TYPE_INT</p>

<p>Fix inconsistency with warnings in typed json encoder</p>

<p>Fix Perl 5.8.0 support</p>

<p>Fixed minor pod typo</p>

<p>Document invalid recursive callbacks or overloads</p>

<p>Fix unicode strings with BOM corrupt -&gt;utf8 state The BOM encoding effects only its very own decode call, not its object.</p>

<p>Fix incr_text refcounts and add incr_rest testcase</p>

<p>Fix encode_stringify string-overload refcnt problem &quot;Attempt to free unreferenced scalar&quot; with convert_blessed and overload.</p>

</dd>
<dt id="Cwd-4.78c"><a>Cwd</a> 4.78c</dt>
<dd>

<p>Fixed long pathnames test for getcwd() on older systems, like debian-7.11 i386, which still returns ENAMETOOLONG on large enough buffers.</p>

<p>Fix the HAS_GET_CURRENT_DIR_NAME check, and the is_ENAMETOOLONG macro. Note that <code>get_current_dir_name()</code> is now in effect, which returns the current PWD, i.e. fastcwd, and not the <code>realpath()</code> (i.e the abs_path) of it. This e.g. broke some DBD::File tests, when behind symlinks.</p>

<p>For getcwd with <code>get_current_dir_name()</code> - i.e. fastcwd - add abs_path. See also <a href="http://perl11.org/blog/fastcwd.html">http://perl11.org/blog/fastcwd.html</a></p>

<p>Don&#39;t translate <i>...</i> to <i>..\..</i> on Win32. (an old <code>command.com</code> limitation) <a href="https://rt.perl.org/Public/Bug/Display.html?id=123724">[perl #123724]</a></p>

<p>Add and use <code>Internals::getcwd()</code>.</p>

</dd>
<dt id="Data::Dumper-2.173"><a>Data::Dumper</a> 2.173</dt>
<dd>

<p>Restore deparsing support in the XS dumper, on Perl 5.18 and earlier.</p>

<p>Fix bug when dumping globs with quoting (which now happens for all Unicode glob names)</p>

<p>Behavior change: <code>$dumper-</code>Useqq(undef)&gt; is now treated as setting the &quot;useqq&quot; option, not getting it (and similarly for other options) <a href="https://rt.perl.org/Public/Bug/Display.html?id=113090">[perl #113090]</a></p>

<p>Quote glob names better; notably, Unicode globs are now handled correctly. <a href="https://rt.perl.org/Public/Bug/Display.html?id=119831">[perl #119831]</a></p>

</dd>
<dt id="deprecate-0.04_01"><a>deprecate</a> 0.04_01</dt>
<dd>

<p>expanded the documentation</p>

</dd>
<dt id="Devel::Peek-1.28_03"><a>Devel::Peek</a> 1.28_03</dt>
<dd>

<p>adjust Devel::Peek pod to cperl FLAGS</p>

</dd>
<dt id="Devel::PPPort-3.53_04"><a>Devel::PPPort</a> 3.53_04</dt>
<dd>

<p>* PL_in_sub only with v5.29.0c</p>

<p>* Merge 3.52 with cperl improvements:</p>

<pre><code>     cperl croak_no_modify adds now the SV to the message.
     support make --silent.
     support devel VERSION with _
     fix deps
     sync embed.fnc with cperl core, with #ifdef USE_CPERL
     sync parts with 5.30 updates</code></pre>

<p>* Revert &quot;Use latest blead embed.fnc&quot;</p>

<pre><code>     It changed the meaning of several flags (n=&gt;T, s=&gt;S,M=&gt;x,...) just for
     some apidocs troubles which are easily solved otherwise.
     It breaks backcompat, and breaks the equality of core embed.fnc.
     perl5.30 also rejected it</code></pre>

<p>* make regen is now in two modes: cperl or perl5 (as in cperl-core embed_lib)</p>

<p>* Add croak_no_modify_sv</p>

<p>* Remove implemented TODOs</p>

<p>* Fix for older EUMM &lt;6.46 which has no META_MERGE</p>

<p>* fix 5.6.0 tests with early Test::Harness: add done_testing, support plan =&gt; no_plan, fallback =&gt; NN for 5.6.0 (Test::Harness &lt; 2), avoid Test.pm, skip git diff, as make regen is different there, skip 3 failing 5.6.0 tests in ppphtest</p>

</dd>
<dt id="Devel::NYTProf-6.06_03"><a>Devel::NYTProf</a> 6.06_03</dt>
<dd>

<p>CVE-2019-11358 + CVE-2015-9251 jquery-1.12.4.js update to latest v3.4.1.</p>

<p>Also update the two plugins to latest, and adjusted the tablesorter css.</p>

</dd>
<dt id="DynaLoader-2.09c"><a>DynaLoader</a> 2.09c</dt>
<dd>

<p>Extend <code>dl_find_symbol</code> on dl_win32 to mimic the POSIX behaviour with an empty libhandle argument: Search the symbol in all loaded shared libraries. This is a convenience platform-compat feature for the <a>ffi</a>.</p>

</dd>
<dt id="Encode-3.01"><a>Encode</a> 3.01</dt>
<dd>

<p>Add <code>Encode::ONLY_PRAGMA_WARNINGS</code> by default to <code>:encoding</code> layer variable <code>$PerlIO::encoding::fallback</code>.</p>

<p>ONLY_PRAGMA_WARNINGS reports only those warnings which are currently enabled by pragma warnings. When ONLY_PRAGMA_WARNINGS is not set then Encode would report all warnings. ONLY_PRAGMA_WARNINGS would have no effect when flag ENCODE_WARN_ON_ERR is not set.</p>

</dd>
<dt id="Errno-1.30_01"><a>Errno</a> 1.30_01</dt>
<dd>

<p>Make <i>Errno_pm.PL</i> compatible with <i>/usr/include/&lt;ARCH&gt;/errno.h</i>. Protect from including some avx512 intrinsics directly on mingw.</p>

</dd>
<dt id="ExtUtils::Embed-1.36"><a>ExtUtils::Embed</a> 1.36</dt>
<dd>

<p>Added optimize to ccopts, required for <code>-flto</code>. Fixed documentation of ccopts. Fixed test to use ccopts, include local -I.., indentation, remove wrong -O hack.</p>

</dd>
<dt id="ExtUtils::Manifest-1.72"><a>ExtUtils::Manifest</a> 1.72</dt>
<dd>

<p>Minor internal changes only</p>

</dd>
<dt id="ExtUtils::MakeMaker-8.35_08"><a>ExtUtils::MakeMaker</a> 8.35_08</dt>
<dd>

<p>Added <code>-flto</code> support for static libs (need the lto plugin) and D for deterministic builds, using arflags for AR_STATIC_ARGS, not just &#39;cr&#39;.</p>

<p>fix FULLPERL for win32 cperl</p>

</dd>
<dt id="ExtUtils::ParseXS"><a>ExtUtils::ParseXS</a></dt>
<dd>

<p>(perl #133654) don&#39;t include OUTLIST parameters in the prototype: The generated prototype (with PROTOTYPES: ENABLE) would include OUTLIST parameters, but these aren&#39;t arguments to the perl function.</p>

</dd>
<dt id="feature-1.54_01"><a>feature</a> 1.54_01</dt>
<dd>

<p><code>array_base</code> was removed.</p>

</dd>
<dt id="File::Copy-2.34"><a>File::Copy</a> 2.34</dt>
<dd>

<p>Add note to close or flush filehandles before calling copy or move.</p>

</dd>
<dt id="File::Find-1.36"><a>File::Find</a> 1.36</dt>
<dd>

<p><code>$File::Find::dont_use_nlink</code> now defaults to 1 on all platforms. Fixes <a href="https://rt.perl.org/Public/Bug/Display.html?id=133673">[perl #133673]</a>, <a href="https://rt.perl.org/Public/Bug/Display.html?id=128894">[perl #128894]</a>, and <a href="https://rt.perl.org/Public/Bug/Display.html?id=126144">[perl #126144]</a>.</p>

</dd>
<dt id="File::Glob-1.32"><a>File::Glob</a> 1.32</dt>
<dd>

<p>Fatalized File::Glob::glob(), which was deprecated since 5.8. However, no deprecation message was issued; only perl5.008delta.pod and a comment in the file mention its deprecation. The warnings was added with v5.25.10.</p>

</dd>
<dt id="File::Path-3.16_02c"><a>File::Path</a> 3.16_02c</dt>
<dd>

<p>Fix symlink abort crossing mountpoint with CPAN::Distribution previous directory ~/.cpan/build changed before entering tmp-32186, expected dev=47 ino=244719549, actual dev=47 ino=33303, aborting at CPAN/Distribution.pm line 591</p>

<p>Fix method of generating names for dummy users and groups during testing (i.e. under docker) <a href="https://rt.cpan.org/Ticket/Display.html?id=121967">[cpan #121967]</a>.</p>

</dd>
<dt id="GDBM_File-1.18"><a>GDBM_File</a> 1.18</dt>
<dd>

<p>Add SECURITY AND PORTABILITY warning paragraph to pod.</p>

</dd>
<dt id="IO-1.40_02"><a>IO</a> 1.40_02</dt>
<dd>

<p>Skip EINVAL on FreeBSD tests when binding a tcp listener on localhost.</p>

</dd>
<dt id="IO::Socket::IP-0.39_03"><a>IO::Socket::IP</a> 0.39_03</dt>
<dd>

<p>Allow ETIMEDOUT on FreeBSD INET6 socket with V6Only true. <a href="https://rt.cpan.org/Ticket/Display.html?id=128986">[cpan #128986]</a></p>

</dd>
<dt id="IO::Zlib-1.10_01"><a>IO::Zlib</a> 1.10_01</dt>
<dd>

<p>Fixed parallel testing <a href="https://rt.cpan.org/Ticket/Display.html?id=1105700">[cpan #105700]</a></p>

<p>probe for more external gzips, make t/external.t strict safe.</p>

</dd>
<dt id="JSON::PP-4.02_01"><a>JSON::PP</a> 4.02_01</dt>
<dd>

<p>Upstream + Keep some of our cperl-specific docs</p>

</dd>
<dt id="lib-0.65"><a>lib</a> 0.65</dt>
<dd>

<p>Hint about $dir/$version is checked by lib.pm and deleted from @INC</p>

</dd>
<dt id="Math::BigInt-1.999814"><a>Math::BigInt</a> 1.999814</dt>
<dd>

<p>Add <code>to_base()</code> and <code>from_base()</code> to <a>Math::BigInt</a> and corresponding library methods <code>_to_base()</code> and <code>_from_base()</code> to <a>Math::BigInt::Lib</a>. This was inspired by <a href="https://rt.cpan.org/Ticket/Display.html?id=122681">CPAN RT #122681</a>.</p>

<p>In the documentation for each of the <code>to_(bin|hex|oct|bytes)</code> methods, add a reference to the corresponding <code>from_(bin|hex|oct|bytes)</code> method.</p>

</dd>
<dt id="Math::BigInt::FastCalc-0.5008"><a>Math::BigInt::FastCalc</a> 0.5008</dt>
<dd>

<p>No code nor test changes.</p>

</dd>
<dt id="mro-1.22_02"><a>mro</a> 1.22_02</dt>
<dd>

<p>Fix -Wmaybe-uninitialized warnings</p>

</dd>
<dt id="NDBM_File-1.15"><a>NDBM_File</a> 1.15</dt>
<dd>

<p>Add SECURITY AND PORTABILITY warning paragraph to pod.</p>

</dd>
<dt id="Net::Ping-2.72"><a>Net::Ping</a> 2.72</dt>
<dd>

<p>Features</p>

<p>Allow data_size &gt; 1024, up to 65535, i.e. fragmented packets. It is recommended to stay below 1472 though for the typical 1500 MTU. Many simple devices do not allow fragmented ICMP packets (&gt; 1472). <a href="https://rt.cpan.org/Ticket/Display.html?id=17409">[cpan #17409]</a></p>

<p>Bugfixes</p>

<p>Fix the max_datasize documentation</p>

<p>Test fixes</p>

<p>The 2 sudo tests on PERL_CORE with a shared perl lib. Skip failing freebsd localhost resolver tests.</p>

</dd>
<dt id="ODBM_File-1.16"><a>ODBM_File</a> 1.16</dt>
<dd>

<p>Add SECURITY AND PORTABILITY warning paragraph to pod.</p>

</dd>
<dt id="Opcode-1.40_03c"><a>Opcode</a> 1.40_03c</dt>
<dd>

<p>Restrict the new op &#39;enterffi&#39;.</p>

</dd>
<dt id="perlfaq-5.20180915"><a>perlfaq</a> 5.20180915</dt>
<dd>

</dd>
<dt id="PerlIO::encoding-0.27_01"><a>PerlIO::encoding</a> 0.27_01</dt>
<dd>

<p>Warnings enabled by setting the <code>WARN_ON_ERR</code> flag in <code>$PerlIO::encoding::fallback</code> are now only produced if warnings are enabled with <code>use warnings &quot;utf8&quot;;</code> or setting <code>$^W</code>. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131683">[perl #131683]</a></p>

</dd>
<dt id="PerlIO::scalar-0.30"><a>PerlIO::scalar</a> 0.30</dt>
<dd>

<p>Allow Off_t smaller than size_t. (Win64 with USE_LARGE_FILES=undef) <a href="https://rt.perl.org/Public/Bug/Display.html?id=133422">[perl #133422]</a></p>

</dd>
<dt id="perldb.pl-1.54_03c"><i>perldb.pl</i> 1.54_03c</dt>
<dd>

<p>Typos in pod.</p>

</dd>
<dt id="POSIX-1.87_03"><a>POSIX</a> 1.87_03</dt>
<dd>

<p>Use quadmath versions of log10, ldexp and signbit. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133510">[perl #133510]</a></p>

<p><i>stdio.h</i> on Cygwin doesn&#39;t expose <code>cuserid</code> with <code>_GNU_SOURCE</code></p>

</dd>
<dt id="SDBM_File-1.15"><a>SDBM_File</a> 1.15</dt>
<dd>

<p>Add SECURITY AND PORTABILITY warning paragraph to pod.</p>

</dd>
<dt id="re-0.37_01"><a>re</a> 0.37_01</dt>
<dd>

<p>Document <code>-Drv</code></p>

</dd>
<dt id="Safe-2.40_03c"><a>Safe</a> 2.40_03c</dt>
<dd>

<p>Fix a test for CORE::dump</p>

</dd>
<dt id="sigtrap-1.09"><a>sigtrap</a> 1.09</dt>
<dd>

<p>Adapt for layers on STDERR, which failed if PERL_UNICODE was set and the current locale was a UTF-8 locale.</p>

</dd>
<dt id="Socket-2.027_05"><a>Socket</a> 2.027_05</dt>
<dd>

<p>re-order and comment deprecated IDN constants.</p>

</dd>
<dt id="Storable-3.15_04"><a>Storable</a> 3.15_04</dt>
<dd>

<p>Fix and clarify handling of recurs_sv. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133326">[perl #133326]</a></p>

<p>Remove exploit code from the pod, which triggered virus scanners. Note that the perl5 release did that wrong. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133706">[perl #133706]</a></p>

<p>Keep Storable::Limit, in opposition to <a href="https://rt.perl.org/Public/Bug/Display.html?id=133708">[perl #133708]</a>. Not my idea, but removing it is even worse. The ticket goal is fine, but the implementation not.</p>

<p>Fix cxt-&gt;pseen leak</p>

<p>Enable &gt;2GB AvFILL check on store_hook (64bit) Too many references returned by STORABLE_freeze. It wrapped around previously. Fixes Coverity CID #187854. Move __Storable__.pm into Storable_pm.PL <a href="https://github.com/perl11/cperl/issues/374">[cperl #374]</a></p>

</dd>
<dt id="threads::shared-1.60"><a>threads::shared</a> 1.60</dt>
<dd>

<p>add extra lock tracing via -DSHARED_TRACE_LOCKS</p>

</dd>
<dt id="Time::HiRes-1.9760_02"><a>Time::HiRes</a> 1.9760_02</dt>
<dd>

<p>make utime() available only if we have both fd and name setting <a href="https://rt.perl.org/Public/Bug/Display.html?id=133030">[perl #133030]</a></p>

<p>Adjust Makefile.PL for windows: the DEFINE() in Makefile.PL can&#39;t be be in sub init() because that sub isn&#39;t called on windows</p>

<p>t/itimer.t: avoid race condition. don&#39;t truncate nanosec utime</p>

<p>fallback/const-c.inc: Avoid compiler warning showing up on darwin.</p>

</dd>
<dt id="Unicode::UCD-0.71_03"><a>Unicode::UCD</a> 0.71_03</dt>
<dd>

<p>Preserve old-style casing for <code>%SCRIPTS</code>, i.e. <code>Egyptian_hieroglyphs</code> for <code>Egyptian_Hieroglyphs</code>.</p>

</dd>
<dt id="vars-1.05_01c"><a>vars</a> 1.05_01c</dt>
<dd>

<p><i>vars.pm</i> no longer disables non-vars strict when checking if strict vars is enabled. <a href="https://rt.perl.org/Public/Bug/Display.html?id=130674">[perl #130674]</a></p>

</dd>
<dt id="version-0.9924_02"><a>version</a> 0.9924_02</dt>
<dd>

<p>more test fixes for 5.6</p>

</dd>
<dt id="warnings-1.43"><a>warnings</a> 1.43</dt>
<dd>

<p>Add <code>ffi</code></p>

</dd>
<dt id="Win32-0.52_02"><a>Win32</a> 0.52_02</dt>
<dd>

<p>Fix various -Wunused warnings, added () usage croaks. Fixed a -Warray-bounds buffer overflow in LONGPATH, and two -Wmaybe-uninitialized.</p>

<p>item <a>XS::Typemap</a> 0.17</p>

<p>Fixed internal leaks</p>

</dd>
</dl>

<h2 id="Removed-Modules-and-Pragmata">Removed Modules and Pragmata</h2>

<ul>

<li><p><a>arybase</a> was removed.</p>

<p>Setting <code>$[</code> to a non-zero value has been deprecated since Perl 5.12 and throws a fatal error as of Perl 5.30. See <a href="/cperl/perldeprecation.html#Assigning-non-zero-to-is-fatal">&quot;Assigning non-zero to <code>$[</code> is fatal&quot; in perldeprecation</a></p>

</li>
<li><p><a>B::Debug</a> is no longer distributed with the core distribution. This was announced with v5.28.0. It remains available on CPAN.</p>

</li>
</ul>

<h1 id="Documentation">Documentation</h1>

<h2 id="Changes-to-Existing-Documentation">Changes to Existing Documentation</h2>

<p>We have attempted to update the documentation to reflect the changes listed in this document. If you find any we have missed, send email to <a href="mailto:perlbug@perl.org">perlbug@perl.org</a>.</p>

<p>Additionally, the following selected changes have been made:</p>

<h3 id="perlfaq-5.201809151"><a>perlfaq</a> 5.20180915</h3>

<ul>

<li><p>prepend &quot;./&quot; to local require calls. Mojolicious ands Dancer2 are not called young anymore.</p>

</li>
</ul>

<h3 id="perlvar"><a href="/cperl/perlvar.html">perlvar</a></h3>

<ul>

<li><p>More specific documentation of paragraph mode. <a href="https://rt.perl.org/Ticket/Display.html?id=133722">[perl #133722]</a>.</p>

</li>
</ul>

<h3 id="perlhacktips"><a href="/cperl/perlhacktips.html">perlhacktips</a></h3>

<ul>

<li><p>Added a <a href="/cperl/perlhacktips.html#COMPILER-OPTIMIZATIONS">&quot;COMPILER OPTIMIZATIONS&quot; in perlhacktips</a> section, with LTO, PGO, AutoFDO, prelink and BOLT tips.</p>

</li>
</ul>

<h1 id="Diagnostics">Diagnostics</h1>

<p>The following additions or changes have been made to diagnostic output, including warnings and fatal error messages. For the complete list of diagnostic messages, see <a href="/cperl/perldiag.html">perldiag</a>.</p>

<h2 id="New-Diagnostics">New Diagnostics</h2>

<h3 id="New-Errors">New Errors</h3>

<ul>

<li><p><a href="/cperl/perldiag.html#Invalid-script-s-in-identifier-s-for-U-X-Limited-Use-scripts-are-forbidden">Invalid script %s in identifier %s for U+%X, Limited Use scripts are forbidden</a> See <a href="#Disallowed-Limited-Use-Scripts">&quot;Disallowed Limited Use Scripts&quot;</a>.</p>

</li>
<li><p><a href="/cperl/perldiag.html#ffi_prep_cif-error-d:-s-at-s-line-d">ffi_prep_cif error %d: %s at %s, line %d</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#An-extern-sub-may-not-have-a-prototype">An extern sub may not have a prototype</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#ffi-not-available">ffi not available</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Illegal-declaration-of-extern-subroutine-s.-Need-signature">Illegal declaration of extern subroutine %s. Need signature</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Illegal-:encoded-s-argument">Illegal :encoded(%s) argument</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Illegal-:nativeconv-s-argument">Illegal :nativeconv(%s) argument</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Invalid-:-s-s-attribute-argument-type">Invalid :%s(%s) attribute argument type</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Missing-type-for-extern-sub-argument-s">Missing type for extern sub argument %s</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#nativeconv-is-only-valid-for-:native-or-extern-sub">:nativeconv is only valid for :native or extern sub</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Null-extern-sub-symbol">Null extern sub symbol</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#s-attribute-argument-missing">:%s() attribute argument missing</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#s-is-only-valid-for-:native-or-extern-sub">:%s is only valid for :native or extern sub</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Unknown-ffi-return-type-:-s-assume-:void">Unknown ffi return type :%s, assume :void</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Attempt-to-change-hash-while-iterating-over-it">Attempt to change hash while iterating over it</a></p>

</li>
</ul>

<h3 id="New-Warnings">New Warnings</h3>

<ul>

<li><p><a href="/cperl/perldiag.html#Subroutine-s::-s-masks-existing-package-s::-s">Subroutine &amp;%s::%s masks existing package %s::%s</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Subroutine-s-masks-new-package-s">Subroutine &amp;%s masks new package %s</a> and <a href="/pod/perldiag.html#Subroutine-s-masks-new-class-s">Subroutine &amp;%s masks new class %s</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#ffi:-Possible-s-overflow-d">ffi: Possible %s overflow %d</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#no-ffi-without-DynaLoader">no ffi without DynaLoader</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#symbol-is-already-resolved">:symbol is already resolved</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Use-of-s-in-p-or-P-is-deprecated-because:-s">Use of &#39;%s&#39; in \p{} or \P{} is deprecated because: %s</a></p>

</li>
</ul>

<h2 id="Changes-to-Existing-Diagnostics">Changes to Existing Diagnostics</h2>

<ul>

<li><p>cperl fatalized the error on non-grapheme string delimiters (ie. illegal utf8) in v5.25.3c already, e.g with <code>qr ̂foobar̂</code>. perl5 did it with v5.29.0 but used 3 error lines instead of just one.</p>

<p>&quot;Use of unassigned code point or non-standalone grapheme for a delimiter&quot; uses now 3 lines: &quot;Use of unassigned code point or non-standalone grapheme for a delimiter is not allowed at -, near&quot; &quot;Use of unassigned code point or non-standalone grapheme for a delimiter is not allowed at -, near&quot; &quot;Execution of - aborted due to compilation errors.&quot;</p>

</li>
<li><p>cperl fatalized Limited_Use scripts in identifiers with v5.29.2c, they were valid before and acted like %utf8::EXCLUDED_SCRIPTS, i.e. they needed to be declared. Now they throw the <a href="/cperl/perldiag.html#Invalid-script-s-in-identifier-s-for-U-X-Limited-Use-scripts-are-forbidden">Invalid script %s in identifier %s for U+%X, Limited Use scripts are forbidden</a> error. See <a href="#Disallowed-Limited-Use-Scripts">&quot;Disallowed Limited Use Scripts&quot;</a>.</p>

</li>
<li><p>No autovivification of hash slice anymore</p>

<p>Added note that this warning is only enabled with the lexical <code>syntax</code> warnings category, not <code>-w</code> anymore.</p>

</li>
<li><p>Unescaped left brace in regex is deprecated here (and will be fatal in Perl 5.32), passed through in regex; marked by <span style="white-space: nowrap;">&lt;-- HERE</span> in m/%s/</p>

<p>Added note that cperl allows more. In cperl only the combinations with <code>\NpPbBxog{}</code> are illegal.</p>

</li>
</ul>

<h1 id="Configuration-and-Compilation">Configuration and Compilation</h1>

<dl>

<dt id="ULTO">-ULTO</dt>
<dd>

<p><code>ccflags</code> or <code>cc</code> containing <code>-ULTO</code> does not probe and add <code>-flto</code> flags. (This is useful for faster B::C testing)</p>

</dd>
<dt id="configpm">configpm</dt>
<dd>

<p>Avoid bumping <i>config.sh</i>/<i>config.h</i> mtimes when adding valid libffi targets in <i>configpm</i>. This caused massive miniperl rebuilds, but is only needed for perl-dependent targets much later.</p>

</dd>
<dt id="embed.fnc">embed.fnc</dt>
<dd>

<p>Added <code>#ifdef USE_CPERL</code> and <code>#if PERL_VERSION &lt;28</code> to the API declaration in <i>embed.fnc</i>, making clear the perl5 and cperl API differences in args, argtypes and API declarations.</p>

<p><i>regen/embed_lib.pl</i> was extended to handle regen-time branches, and ignore perl5 and older verion branches.</p>

<p>Devel-PPPort <i>embed.fnc</i> can now be the same as the core <i>embed.fnc</i>.</p>

</dd>
<dt id="flto">-flto</dt>
<dd>

<p>Without <code>DEBUGGING</code> the best <code>-flto</code> Link Time Optimization flag is now added to the default ccflags. See <a href="http://perl11.org/blog/bolt.html">http://perl11.org/blog/bolt.html</a> and <a href="https://github.com/perl11/cperl/issues/381">[cperl #381]</a>.</p>

<p>The correct -flto= variant is then used for ldflags and lddlflags also. cldflags contains now also the optimize settings, needed for -flto.</p>

<p>ar is replaced by llvm-ar-$ver if needed.</p>

</dd>
<dt id="ccname-clang">ccname clang</dt>
<dd>

<p><code>ccname</code> is now set to &quot;clang&quot; for clang, not &quot;gcc&quot;.</p>

</dd>
<dt id="ccname-icc">ccname icc</dt>
<dd>

<p>On linux &quot;icc&quot; is also set for <code>ccname</code>, and <code>-O3</code> is preferred over <code>-O2</code> in most non-DEBUGGING cases with newer compilers.</p>

</dd>
<dt id="llvmversion">llvmversion</dt>
<dd>

<p><code>llvmversion</code> string added, like &quot;6.0.1-9.1 (tags/RELEASE_601/final)&quot;, analog to <code>gccversion</code>. With clang both variables are set.</p>

</dd>
<dt id="llvmsuffix">llvmsuffix</dt>
<dd>

<p>Added <code>llvmsuffix</code> config, for bitcode-enabled ar, ranlib, llvm-profdata.</p>

</dd>
<dt id="ar---plugin">ar --plugin</dt>
<dd>

<p>Added <code>ar --plugin</code> path to the gcc <i>lto_plugin</i>, required for binutils <code>ar</code> with static libs with <code>-flto</code>. Esp. on cygwin. Ditto for <code>ranlib</code>.</p>

</dd>
<dt id="autofdo">.autofdo</dt>
<dd>

<p>Added clang and useshrplib support for the two <b>.autofdo</b> targets. See <a href="/cperl/perlhacktips.html#AutoFDO">&quot;AutoFDO&quot; in perlhacktips</a>.</p>

</dd>
<dt id="pgo">.pgo</dt>
<dd>

<p>Added two <b>.pgo</b> targets, analog to autofdo. See <a href="/cperl/perlhacktips.html#PGO">&quot;PGO&quot; in perlhacktips</a>.</p>

</dd>
<dt id="archname">archname</dt>
<dd>

<p>Set <code>archname</code> and the target triple <code>myarchname</code> earlier, right after osname.</p>

</dd>
<dt id="Uinstallmandirs">-Uinstallmandirs</dt>
<dd>

<p>With <code>-Uinstallmandirs</code> all four variables <code>installman1dir</code>, <code>installman3dir</code>, <code>installsiteman1dir</code> and <code>installsiteman3dir</code> are set to none, skipping installing all man pages.</p>

</dd>
<dt id="useffi">useffi</dt>
<dd>

<p>Added if <i>ffi.h</i> is being found. If so the <code>incpth</code>, <code>ccflags</code> and <code>libs</code> is extended to include libffi.</p>

</dd>
<dt id="ffi_targets">ffi_targets</dt>
<dd>

<p>With <code>useffi</code> this space-seperated string is filled with the valid and supported <code>:nativeconv()</code> ABI&#39;s, in uppercase. Matching HAVE_FFI_* defines in <i>config.h</i>. See <a>&quot;nativeconv(STRING)&quot; in attributes</a>.</p>

</dd>
<dt id="usesafehashiter">usesafehashiter</dt>
<dd>

<p>Disable destructive hash key modifications during iteration by default. <code>use hashiter;</code> to allow it. <a href="https://github.com/perl11/cperl/issues/117">[cperl #117]</a></p>

</dd>
<dt id="doubleinfbytes-doublenanbytes-longdblinfbytes-longdblnanbytes">doubleinfbytes,doublenanbytes,longdblinfbytes,longdblnanbytes</dt>
<dd>

<p>Fixed the error cases when the double or long double probes returned undef.</p>

</dd>
<dt id="Porting-do-make-cperl-release"><i>Porting/do-make-cperl-release</i></dt>
<dd>

<p>Replace <code>sha1sum</code> with <code>sha256sum</code>, add <code>gpg -a -b $pkg</code>.</p>

</dd>
</dl>

<h1 id="Testing">Testing</h1>

<p>Tests were added and changed to reflect the other additions and changes in this release. Furthermore, these significant changes were made:</p>

<ul>

<li><p>All modules can now be tested in parallel. From the remaining exceptions <i>ext/Pod-Html/t</i> was fixed a while ago, and <i>cpan/IO-Zlib/t</i> with this release.</p>

<p>We also removed the remaining exception for files starting with 0. We assumed before that the reason a test file&#39;s name begins with a 0 is to order its execution among the tests in its directory. Hence, a directory containing such files should be tested in serial order. But in reality there&#39;s no such <i>t/00-setup.t</i> test and if so, it would still be run as very first test. CPAN testing via EUMM and Test::Harness does not obey this rule neither. The only module to be fixed was <i>ext/FileCache/t</i>. cperl-only.</p>

</li>
<li><p><i>t/TEST</i> does not need any temp_needs_dot exceptions anymore. All core modules are now <i>.</i> in <code>@INC</code> clean. The only module to be fixed was <i>cpan/libnet/t</i>. cperl-only.</p>

</li>
<li><p>Thoroughly test paragraph mode, using a new test file, <i>t/io/paragraph_mode.t</i>. <a href="https://rt.perl.org/Ticket/Display.html?id=133722">[perl #133722]</a>.</p>

</li>
<li><p><i>lib/utf8_heavy.t</i> was split away from <i>lib/utf8.t</i> to test utf8_heavy only functions, mostly SCRIPTS. cperl-only.</p>

</li>
<li><p>Added <code>is_CI</code> detection function to <i>t/TEST</i>.</p>

</li>
<li><p>Honor more <b>SKIP_SLOW_TESTS</b>, esp. with B-C, esp. with <code>-flto</code>. Document all used ENV vars in <i>t/harness</i>.</p>

</li>
<li><p><i>op/hash-rt85026.t</i> finds now almost ever a collision, and skips the test with usesafehashiter enabled (the default). Such not easily detectable destructive hash iters are now forbidden, thanks to <b>usesafehashiter</b>.</p>

</li>
<li><p><i>op/chdir.t</i> when pwd is a symlink.</p>

</li>
</ul>

<h1 id="Platform-Support">Platform Support</h1>

<h2 id="Platform-Specific-Notes">Platform-Specific Notes</h2>

<dl>

<dt id="Oracle-Linux">Oracle Linux</dt>
<dd>

<ul>

<li><p>DTrace support has been added by also looking for <i>/sbin/dtrace</i>. Install it with <code>sudo yum install -y dtrace-utils dtrace-utils-devel</code>.</p>

</li>
</ul>

</dd>
<dt id="Mac-OS-X">Mac OS X</dt>
<dd>

<ul>

<li><p>Perl&#39;s build and testing process on Mac OS X for <code>-Duseshrplib</code> builds is now compatible with Mac OS X System Integrity Protection (<b>SIP</b>).</p>

<p>SIP prevents binaries in <i>/bin</i> (and a few other places) being passed the <code>DYLD_LIBRARY_PATH</code> environment variable. For our purposes this prevents <code>DYLD_LIBRARY_PATH</code> from being passed to the shell, which prevents that variable being passed to the testing or build process, so running <code>perl</code> couldn&#39;t find <i>libcperl.dylib</i>.</p>

<p>To workaround that, the initial build of the <i>perl</i> executable expects to find <i>libcperl.dylib</i> in the build directory, and the library path is then adjusted during installation to point to the installed library.</p>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=126706">[perl #126706]</a></p>

</li>
<li><p>Macports <b>gcc-mp-9 -O</b> is broken with <i>ext/Config</i>. You need to use a different compiler. <a href="https://github.com/perl11/p5-Config/issues/13">[p5-Config #13]</a></p>

</li>
</ul>

</dd>
<dt id="Win32">Win32</dt>
<dd>

<ul>

<li><p><code>sleep()</code> with warnings enabled for a <code>USE_IMP_SYS</code> build no longer warns about the sleep timeout being too large. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133376">[perl #133376]</a></p>

</li>
<li><p>Support for compiling perl on Windows using Microsoft Visual Studio 2019 (containing Visual C++ 14.2) has been added.</p>

</li>
<li><p>Add DynaLoader fallbacks to <code>dl_find_symbol</code> to mimic the POSIX behaviour with an empty libhandle argument: Search the symbol in all loaded/most shared libraries. This is a convenience platform-compat feature for the <a>ffi</a>.</p>

</li>
<li><p>The new Windows 10 DTrace support has not been tested yet.</p>

</li>
</ul>

</dd>
<dt id="Linux">Linux</dt>
<dd>

<ul>

<li><p>The hints now detect newer compilers and set optimize=-O3 by default, needed for better -flto and inlining support, instead of -O2.</p>

</li>
</ul>

</dd>
<dt id="FreeBSD">FreeBSD</dt>
<dd>

<ul>

<li><p>Added <i>/usr/local/include</i> to <code>incpth</code>, which helps probing libffi during <i>configpm</i>. If was only in ccflags via <code>-I</code>.</p>

</li>
<li><p>Fixed wrong clang <code>llvm-ar$llvmsuffix</code> and <code>arflags</code>. BSD ar is fine to use <code>-D</code>.</p>

</li>
<li><p>Improved clang -flto support, set default optimize to -O3. -flto still needs the extra gold linker from a clang/llvm ports package for static archives.</p>

</li>
</ul>

</dd>
<dt id="AIX">AIX</dt>
<dd>

<ul>

<li><p>Fix &#39;for reverse @array&#39; bug on AIX. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133558">[perl #133558]</a></p>

</li>
</ul>

</dd>
<dt id="cygwin">cygwin</dt>
<dd>

<ul>

<li><p>Fixed <code>boot_Win32CORE</code> prototype to skip dllexport, fatal with <code>-flto</code>.</p>

</li>
<li><p>Fixed ar for <i>Win32CORE.a</i> by using the gcc liblto plugin.</p>

</li>
<li><p>Skip probing for <code>-flto</code> on cygwin. This reliably fails to find a proper image-base with that many new symbols, the adress space is just too small: <code>Invalid relocation. Offset 0x.. at address 0x.. doesn&#39;t fit into 32 bits</code></p>

</li>
</ul>

</dd>
<dt id="mingw">mingw</dt>
<dd>

<ul>

<li><p>Fixed Errno from processing some protected intrinsics directly, which fail with #error &quot;Never use &lt;avx512vpopcntdqintrin.h&gt;, &lt;avx512ifmaintrin.h&gt; directly; include &lt;immintrin.h&gt; instead.&quot; #error &quot;Never use &lt;fmaintrin.h&gt; directly; include &lt;immintrin.h&gt; instead.&quot; #error &quot;Never use &lt;xsavesintrin.h&gt; directly; include &lt;x86intrin.h&gt; instead.&quot;</p>

</li>
</ul>

</dd>
</dl>

<h1 id="Internal-Changes">Internal Changes</h1>

<ul>

<li><p>The first sizing pass has been eliminated from the regular expression compiler. An extra pass may instead be needed in some cases to count the number of parenthetical capture groups.</p>

</li>
<li><p>Added <code>my_atof3()</code> to support parsing strings which are not necessarily NUL-terminated to an NV. <code>grok_atoUV</code> supports that too now.</p>

</li>
<li><p>It is now forbidden to malloc more than <code>PTRDIFF_T_MAX</code> bytes. Much code (including C optimizers) assumes that all data structures will not be larger than this, so this catches such attempts before overflow happens.</p>

</li>
<li><p>A new function <a href="/cperl/perlapi.html#my_strtod">&quot;<code>my_strtod</code>&quot; in perlapi</a> or its synonym, Strtod(), is now availabe with the same signature as the libc strtod(). It provides strotod() equivalent behavior on all platforms, using the best available precision, depending on platform capabilities and <i>Configure</i> options, while handling locale-related issues, such as if the radix character should be a dot or comma.</p>

</li>
<li><p>Enabled USE_REENTRANT_API with threads by default on all platforms. See <i>reentr.c</i>. Previously it was only enabled by default on darwin.</p>

</li>
</ul>

<h1 id="Testing1">Testing</h1>

<ul>

<li><p>Added <i>t/run/envsize.t</i> for <a href="#Restrict-my_setenv-to-ARG_MAX">&quot;Restrict my_setenv to ARG_MAX&quot;</a></p>

</li>
</ul>

<h1 id="Selected-Bug-Fixes">Selected Bug Fixes</h1>

<ul>

<li><p>Regular expression matching no longer leaves stale UTF-8 length magic when updating <code>$^R</code>. This could result in <code>length($^R)</code> returning an incorrect value.</p>

</li>
<li><p>Fixed a failure to match properly.</p>

<p>An EXACTFish regnode has a finite length it can hold for the string being matched. If that length is exceeded, a second node is used for the next segment of the string, for as many regnodes as are needed. Care has to be taken where to break the string, in order to deal multi-character folds in Unicode correctly. If we want to break a string at a place which could potentially be in the middle of a multi-character fold, we back off one (or more) characters, leaving a shorter EXACTFish regnode. This backing off mechanism contained an off-by-one error. <a href="https://rt.perl.org/Ticket/Display.html?id=133756">[perl #133756]</a>.</p>

</li>
<li><p>A bare <code>eof</code> call with no previous file handle now returns true. <a href="https://rt.perl.org/Ticket/Display.html?id=133721">[perl #133721]</a></p>

</li>
<li><p>Failing to compile a format now aborts compilation. Like other errors in sub-parses this could leave the parser in a strange state, possibly crashing perl if compilation continued. <a href="https://rt.perl.org/Ticket/Display.html?id=132158">[perl #132158]</a></p>

</li>
<li><p>If an in-place edit is still in progress during global destruction and the process exit code (as stored in <code>$?</code>) is zero, perl will now treat the in-place edit as successful, replacing the input file with any output produced.</p>

<p>This allows code like:</p>

<pre><code>  perl -i -ne &#39;print &quot;Foo&quot;; last&#39;</code></pre>

<p>to replace the input file, while code like:</p>

<pre><code>  perl -i -ne &#39;print &quot;Foo&quot;; die&#39;</code></pre>

<p>will not. Partly resolves <a href="https://rt.perl.org/Ticket/Display.html?id=133659">[perl #133659]</a>.</p>

</li>
<li><p>A regression in 5.28 caused the following code to fail</p>

<pre><code> close(STDIN); open(CHILD, &quot;|wc -l&quot;)&#39;</code></pre>

<p>because the child&#39;s stdin would be closed on exec. This has now been fixed.</p>

</li>
<li><p>Fixed an issue where compiling a regexp containing both compile-time and run-time code blocks could lead to trying to compile something which is invalid syntax.</p>

</li>
<li><p>Fixed build failures with <code>-DNO_LOCALE_NUMERIC</code> and <code>-DNO_LOCALE_COLLATE</code>. <a href="https://rt.perl.org/Ticket/Display.html?id=133696">[perl #133696]</a>.</p>

</li>
<li><p>Prevent the tests in <i>ext/B/t/strict.t</i> from being skipped. <a href="https://rt.perl.org/Ticket/Display.html?id=133713">[perl #133713]</a>.</p>

</li>
<li><p><code>/di</code> nodes ending or beginning in <i>s</i> are now <code>EXACTF</code>. We do not want two <code>EXACTFU</code> to be joined together during optimization, and to form a <code>ss</code>, <code>sS</code>, <code>Ss</code> or <code>SS</code> sequence; they are the only multi-character sequences which may match differently under <code>/ui</code> and <code>/di</code>.</p>

</li>
<li><p><a>SDBM_File</a> is now more robust with corrupt database files. The improvements do not make SDBM files suitable as an interchange format. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132147">[perl #132147]</a></p>

</li>
<li><p><code>binmode($fh);</code> or <code>binmode($fh, &#39;:raw&#39;);</code> now properly removes the <code>:utf8</code> flag from the default <code>:crlf</code> I/O layer on Win32. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133604">[perl #133604]</a></p>

</li>
<li><p><code>pack &quot;u&quot;, &quot;invalid uuencoding&quot;</code> now properly NUL terminates the zero-length SV produced. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132655">[perl #132655]</a></p>

</li>
<li><p>The new in-place editing code no longer leaks directory handles. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133314">[perl #133314]</a></p>

</li>
<li><p>If an in-place edit is still in progress during global destruction and the process exit code (as stored in <code>$?</code>) is zero, perl will now treat the in-place edit as successful, replacing the input file with any output produced.</p>

<p>This allows code like:</p>

<pre><code>  perl -i -ne &#39;print &quot;Foo&quot;; last&#39;</code></pre>

<p>to replace the input file, while code like:</p>

<pre><code>  perl -i -ne &#39;print &quot;Foo&quot;; die&#39;</code></pre>

<p>will not. Partly resolves <a href="https://rt.perl.org/Ticket/Display.html?id=133659">[perl #133659]</a>.</p>

</li>
<li><p>Warnings produced from constant folding operations on overloaded values no longer produce spurious &quot;Use of uninitialized value&quot; warnings. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132683">[perl #132683]</a></p>

</li>
<li><p>Fix for multiconcat &quot;mutator not seen in (lex = ...) .= ...&quot; <a href="https://rt.perl.org/Public/Bug/Display.html?id=133441">[perl #133441]</a></p>

</li>
<li><p>Detect more <a href="/cperl/perldiag.html#This-use-of-my-in-a-false-conditional">&quot;This use of <code>my()</code> in a false conditional&quot; in perldiag</a> cases, esp. scalar assignments like <code>my $x = 0 if 0;</code> <a href="https://rt.perl.org/Public/Bug/Display.html?id=133543">[perl #133543]</a></p>

</li>
<li><p>Regexp script runs were failing to permit ASCII digits in some cases. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133547">[perl #133547]</a></p>

</li>
<li><p>Improve the debugging output for calloc() calls with <code>-Dm</code>. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133439">[perl #133439]</a></p>

</li>
<li><p>On Unix-like systems supporting a platform-specific technique for determining <a href="/cperl/perlvar.html#X"><code>$^X</code></a>, Perl failed to fall back to the generic technique when the platform-specific one fails (for example, a Linux system with <i>/proc</i> not mounted). This was a regression in Perl 5.28.0. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133573">[perl #133573]</a></p>

</li>
<li><p>The experimental reference aliasing feature was misinterpreting array and hash slice assignment as being localised, e.g.</p>

<pre><code>    \(@a[3,5,7]) = \(....);</code></pre>

<p>was being interpreted as:</p>

<pre><code>    local \(@a[3,5,7]) = \(....);</code></pre>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=133538">[perl #133538]</a></p>

</li>
<li><p><code>pack()</code> no longer can return malformed UTF-8. It croaks if it would otherwise return a UTF-8 string that contains malformed UTF-8. This protects agains potential security threats. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131642">[perl #131642]</a></p>

</li>
<li><p>See <a href="#Any-set-of-digits-in-the-Common-script-are-legal-in-a-script-run-of-another-script">&quot;Any set of digits in the Common script are legal in a script run of another script&quot;</a>.</p>

</li>
<li><p>Perl now exposes POSIX <code>getcwd</code> (and on cperl the safer <code>get_current_dir_name</code>) as <code>Internals::getcwd()</code> if available. This is intended for use by <code>Cwd.pm</code> during bootstrapping and may be removed or changed without notice. This fixes some bootstrapping issues while building perl in a directory where some ancestor directory isn&#39;t readable. <a href="https://rt.perl.org/Public/Bug/Display.html?id=133951">[perl #133951]</a></p>

</li>
<li><p>Made the <code>gmtime_r</code> and <code>localtime_r</code> fallbacks thread-safe.</p>

</li>
<li><p>Fix <code>valid_ident()</code> for 128-255 chars not to use isIDFIRST_A nor isIDCONT_A, _A does not match them. Fixes <i>t/uni/method.t</i> for chars like oslash</p>

</li>
<li><p>Fix <code>newSVpvn_share</code> to store the HEK_WASUTF8 flag if downgraded. Improve <code>newSVpvn_share</code> to downgrade only once, not twice.</p>

<p>A shared string and a GV with chars in the range 128-255 are downgraded to bytes without the UTF8 flag. Store at least the HEK_WASUTF8 flag then.</p>

</li>
<li><p>Check bless name under use strict &#39;names&#39;.</p>

<p>The second argument to bless, the new classname, is now checked to be a valid package name identifier when <b>strict &#39;names&#39;</b> is in effect, and the name is now normalized. <a href="https://github.com/perl11/cperl/issues/376">[cperl #376]</a></p>

</li>
<li><p>Fix cperl 5.28.0c regression disallowing calling subnames with a quote in a package qualifier position. <a href="https://github.com/perl11/cperl/issues/371">[cperl #371]</a></p>

<p>This is now valid again:</p>

<pre><code>  sub don&#39;t { 0 } print don&#39;t;</code></pre>

<p>With v5.28.0c only the declaration <code>sub don&#39;t { 0 }</code> was valid, it accepted the subroutine <code>don&#39;t</code>, but the call <code>print don&#39;t;</code> was invalid, it was looking for a second single-quote string delimiter. Note that in cperl <code>&#39;</code> is no perl4-style package seperator.</p>

</li>
</ul>

<h1 id="Known-Problems">Known Problems</h1>

<ul>

<li><p>Latest msys2 gcc compiler fails on two tests: <i>op/sort.t</i> and <i>op/signatures.t</i>.</p>

</li>
<li><p>Detect shared-only import libraries like <i>libNAME.dll.a</i>, which have no static counterpart <i>libNAME.a</i>, which happens e.g. for <code>libffi</code> on <b>cygwin</b> or msys.</p>

</li>
</ul>

<h1 id="Acknowledgements">Acknowledgements</h1>

<p>cperl 5.29.2 represents approximately 3 months of development since cperl 5.29.1c and contains approximately 350,000 lines of changes across 500 files from 42 authors.</p>

<p>Excluding auto-generated files, documentation and release tools, there were approximately 320,000 lines of changes to 270 .pm, .t, .c and .h files.</p>

<p>The following people are known to have contributed the improvements that became cperl 5.29.2:</p>

<p>Karl Williamson, Reini Urban, Tony Cook, James E Keenan, David Mitchell, Sisyphus, Steve Hay, H.Merijn Brand, Dagfinn Ilmari Mannsåker, Tomasz Konojacki, Daniel Dragan, Andy Dougherty, Eugen Konkov, Craig A. Berry, Aaron Crane, Nicolas Rochelemagne, Abigail, Niko Tyni, Slaven Rezic, Chris &#39;BinGOs&#39; Williams, Sawyer X, Phil Pearl (Lobbes), Leon Timmermans, Alexandr Savca, Matthias Bethke, David Cantrell, Shlomi Fish, Dan Dedrick, Unicode Consortium, Yves Orton, Tina Müller, James Clarke, Petr Písař, Graham Knop, François Perrad, Hauke D, E. Choroba, Karen Etheridge, Hugo van der Sanden, John SJ Anderson, Pali, Jim Cromie.</p>

<p>The list above is almost certainly incomplete as it is automatically generated from version control history including the perl and cperl repos. In particular, it does not include the names of the (very much appreciated) contributors who reported issues to the Perl bug tracker and the cperl github issues.</p>

<p>Many of the changes included in this version originated in the CPAN modules included in Perl&#39;s core. We&#39;re grateful to the entire CPAN community for helping Perl to flourish.</p>

<p>For a more complete list of all of Perl&#39;s historical contributors, please see the <i>AUTHORS</i> file in the Perl source distribution.</p>

<p>Generated with:</p>

<pre><code>    cperl Porting/acknowledgements.pl cperl-5.29.1..HEAD -c</code></pre>

<h1 id="Reporting-Bugs">Reporting Bugs</h1>

<p>If you find what you think is a bug, you might check the perl bug database at <a href="https://rt.perl.org/">https://rt.perl.org/</a> . There may also be information at <a href="http://www.perl.org/">http://www.perl.org/</a> , the Perl Home Page.</p>

<p>If you believe you have an unreported bug, please run the <a>cperlbug</a> program included with your release. Be sure to trim your bug down to a tiny but sufficient test case. Your bug report, along with the output of <code>perl -V</code>, will be sent off to perlbug@perl.org to be analysed by the Perl porting team.</p>

<p>If you think it&#39;s a cperl specific bug or trust the cperl developers more please file an issue at <a href="https://github.com/perl11/cperl/issues">https://github.com/perl11/cperl/issues</a>.</p>

<p>If the bug you are reporting has security implications which make it inappropriate to send to a publicly archived mailing list, then see <a href="/cperl/perlsec.html#SECURITY-VULNERABILITY-CONTACT-INFORMATION">&quot;SECURITY VULNERABILITY CONTACT INFORMATION&quot; in perlsec</a> For details of how to report the issue.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p>The <i>Changes</i> file for an explanation of how to view exhaustive details on what changed.</p>

<p>The <i>INSTALL</i> file for how to build Perl.</p>

<p>The <i>README</i> file for general stuff.</p>

<p>The <i>Artistic</i> and <i>Copying</i> files for copyright information.</p>


</body>

</html>



<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@osx201.apple.com" />
</head>

<body style="background-color: white">



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#Core-Enhancements">Core Enhancements</a>
    <ul>
      <li><a href="#Optimize-static-methods-to-subs">Optimize static methods to subs</a></li>
      <li><a href="#Dump-more-COP-fields">Dump more COP fields</a></li>
      <li><a href="#More-unicode-ops">More unicode ops</a></li>
      <li><a href="#delete-on-key-value-slices">delete on key/value slices</a></li>
      <li><a href="#Unicode-10.0-is-supported">Unicode 10.0 is supported</a></li>
      <li><a href="#Re-enable-warnings-illegalproto">Re-enable warnings illegalproto</a></li>
      <li><a href="#In-place-editing-is-now-safer">In-place editing is now safer</a></li>
      <li><a href="#Initialisation-of-aggregate-state-variables">Initialisation of aggregate state variables</a></li>
      <li><a href="#Full-size-inode-numbers">Full-size inode numbers</a></li>
      <li><a href="#Changed-warnings::register-handling-of-all">Changed warnings::register handling of all</a></li>
    </ul>
  </li>
  <li><a href="#Security">Security</a>
    <ul>
      <li><a href="#CVE-2017-12837-Heap-buffer-overflow-in-regular-expression-compiler">[CVE-2017-12837] Heap buffer overflow in regular expression compiler</a></li>
      <li><a href="#CVE-2017-12883-Buffer-over-read-in-regular-expression-parser">[CVE-2017-12883] Buffer over-read in regular expression parser</a></li>
      <li><a href="#CVE-2017-12814-ENV-key-stack-buffer-overflow-on-Windows">[CVE-2017-12814] $ENV{$key} stack buffer overflow on Windows</a></li>
      <li><a href="#Unsigned-long-stack-access-of-printf-format-arguments">Unsigned long stack access of printf format arguments</a></li>
    </ul>
  </li>
  <li><a href="#Incompatible-Changes">Incompatible Changes</a>
    <ul>
      <li><a href="#Comma-less-variable-lists-in-formats-are-no-longer-allowed">Comma-less variable lists in formats are no longer allowed</a></li>
      <li><a href="#The-:locked-and-:unique-attributes-have-been-removed">The :locked and :unique attributes have been removed</a></li>
      <li><a href="#N-with-nothing-between-the-braces-is-now-illegal">\N{} with nothing between the braces is now illegal.</a></li>
      <li><a href="#Opening-the-same-symbol-as-both-a-file-and-directory-handle-is-no-longer-allowed">Opening the same symbol as both a file and directory handle is no longer allowed</a></li>
      <li><a href="#Use-of-bare-to-mean-is-no-longer-allowed">Use of bare &lt;&lt; to mean &lt;&lt;&quot;&quot; is no longer allowed</a></li>
      <li><a href="#Setting-to-a-reference-to-a-non-positive-integer-no-longer-allowed">Setting $/ to a reference to a non-positive integer no longer allowed</a></li>
      <li><a href="#Unicode-code-points-with-values-exceeding-IV_MAX-are-now-fatal">Unicode code points with values exceeding IV_MAX are now fatal.</a></li>
      <li><a href="#B::OP::terse-no-longer-exists">B::OP::terse no longer exists.</a></li>
      <li><a href="#Use-of-inherited-AUTOLOAD-for-non-methods-is-no-longer-allowed">Use of inherited AUTOLOAD for non-methods is no longer allowed.</a></li>
      <li><a href="#Use-of-strings-with-code-points-over-0xFF-is-not-allowed-for-bitwise-string-operators">Use of strings with code points over 0xFF is not allowed for bitwise string operators</a></li>
      <li><a href="#Backslash-no-longer-escapes-colon-in-PATH-for-the--S-switch">Backslash no longer escapes colon in PATH for the -S switch</a></li>
      <li><a href="#Subroutines-no-longer-need-typeglobs">Subroutines no longer need typeglobs</a></li>
      <li><a href="#is-a-term-in-cperl-not-a-statement">... is a term in cperl, not a statement</a></li>
    </ul>
  </li>
  <li><a href="#Deprecations">Deprecations</a>
    <ul>
      <li><a href="#Use-of-1-perlfunc-vec-EXPR-OFFSET-BITS-on-strings-with-code-points-above-0xFF-is-deprecated">Use of $1|perlfunc/vec EXPR,OFFSET,BITS&gt; on strings with code points above 0xFF is deprecated.</a></li>
      <li><a href="#Some-uses-of-unescaped-are-no-longer-fatal">Some uses of unescaped &quot;{&quot; are no longer fatal</a></li>
      <li><a href="#Module-removals">Module removals</a></li>
    </ul>
  </li>
  <li><a href="#Performance-Enhancements">Performance Enhancements</a></li>
  <li><a href="#Modules-and-Pragmata">Modules and Pragmata</a>
    <ul>
      <li><a href="#Removal-of-use-vars">Removal of use vars</a></li>
      <li><a href="#Updated-Modules-and-Pragmata">Updated Modules and Pragmata</a></li>
      <li><a href="#Removed-Modules-and-Pragmata">Removed Modules and Pragmata</a></li>
    </ul>
  </li>
  <li><a href="#Documentation">Documentation</a>
    <ul>
      <li><a href="#New-Documentation">New Documentation</a>
        <ul>
          <li><a href="#PACKAGING">PACKAGING</a></li>
        </ul>
      </li>
      <li><a href="#Changes-to-Existing-Documentation">Changes to Existing Documentation</a>
        <ul>
          <li><a href="#perlapi">perlapi</a></li>
          <li><a href="#perlop">perlop</a></li>
          <li><a href="#perldata">perldata</a></li>
          <li><a href="#perluniprops">perluniprops</a></li>
          <li><a href="#perlintern">perlintern</a></li>
          <li><a href="#perlfilter">perlfilter</a></li>
          <li><a href="#POSIX">POSIX</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#Diagnostics">Diagnostics</a>
    <ul>
      <li><a href="#New-Diagnostics">New Diagnostics</a>
        <ul>
          <li><a href="#New-Errors">New Errors</a></li>
          <li><a href="#New-Warnings">New Warnings</a></li>
        </ul>
      </li>
      <li><a href="#Changes-to-Existing-Diagnostics">Changes to Existing Diagnostics</a></li>
    </ul>
  </li>
  <li><a href="#Configuration-and-Compilation">Configuration and Compilation</a></li>
  <li><a href="#Testing">Testing</a></li>
  <li><a href="#Platform-Support">Platform Support</a>
    <ul>
      <li><a href="#Discontinued-Platforms">Discontinued Platforms</a></li>
      <li><a href="#Platform-Specific-Notes">Platform-Specific Notes</a></li>
    </ul>
  </li>
  <li><a href="#Internal-Changes">Internal Changes</a></li>
  <li><a href="#Selected-Bug-Fixes">Selected Bug Fixes</a></li>
  <li><a href="#Known-Problems">Known Problems</a></li>
  <li><a href="#Acknowledgements">Acknowledgements</a></li>
  <li><a href="#Reporting-Bugs">Reporting Bugs</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>perl5272cdelta - what is new for cperl v5.27.2</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This document describes the differences between the cperl 5.27.1 and the cperl 5.27.2 releases.</p>

<p>If you are upgrading from an earlier release such as v5.24.2c, first read the <a>perl526*cdelta</a> documentation, which describes differences between v5.26.0c and v5.26.2c</p>

<h1 id="Core-Enhancements">Core Enhancements</h1>

<h2 id="Optimize-static-methods-to-subs">Optimize static methods to subs</h2>

<p>When a method call can be proven at compile-time to use a specific subroutine, optimize away the run-time method dispatch on a non-threaded perl. When it is for a XS subroutine, such as with e.g. <code>use strict;</code> which does <code>BEGIN {require strict;} strict-&gt;import;</code> the <code>strict-&gt;import</code> part is optimized from the slow <code>entersub</code> op to the <code>enterxssub</code> op, as if via <code>strict::import(&quot;strict&quot;,...)</code>. The slow GV lookup in entersub cannot be converted to a faster CVref lookup, as this would break dynamic method redefinitions. See <a href="http://blogs.perl.org/users/rurban/2011/06/how-perl-calls-subs-and-methods.html">http://blogs.perl.org/users/rurban/2011/06/how-perl-calls-subs-and-methods.html</a>. This is ~4% faster for each such method call. cperl-only.</p>

<h2 id="Dump-more-COP-fields">Dump more COP fields</h2>

<p>Dump the values of a COP <code>$^H</code>, <code>%^H</code> and the lexical warnings via <code>op_dump()</code> and it&#39;s XS module <a>Devel::Peek</a>. Improve the display of cop SEQ values and ranges, and padnames. Added a DEBUGGING <code>cop_dump()</code> helper, esp. useful for deleted <code>PL_curcop</code>&#39;s. cperl-only.</p>

<h2 id="More-unicode-ops">More unicode ops</h2>

<p>Added the strong unicode fraction op <code>/</code> U+2044, which binds stronger than all other arithmetic ops, and the two unicode multiplication ops <code>&sdot;</code> U+022C5 (dot operator) and <code>&#x2219;</code> U+2219 (multiplication dot), which binds the same as <code>*</code>. cperl-only.</p>

<h2 id="delete-on-key-value-slices"><a href="/cperl/perlfunc.html#delete-EXPR">delete</a> on key/value slices</h2>

<p><a href="/cperl/perlfunc.html#delete-EXPR">delete</a> can now be used on key/value slices, returning the keys along with the deleted values. <a href="https://rt.perl.org/Ticket/Display.html?id=131328">[perl #131328]</a></p>

<h2 id="Unicode-10.0-is-supported">Unicode 10.0 is supported</h2>

<p>A list of changes is at <a href="http://www.unicode.org/versions/Unicode10.0.0">http://www.unicode.org/versions/Unicode10.0.0</a>.</p>

<h2 id="Re-enable-warnings-illegalproto">Re-enable warnings illegalproto</h2>

<p>Parse prototypes for errors again. Either with <code>:prototype()</code> or as signature. Illegal prototypes are not stored. Most illegal protos are subsequently parsed as signature, but some are just wrong protos, such as <code>&#39;[$&#39;</code> missing the <code>&#39;]&#39;</code>, or <code>:prototype($_$)</code>.</p>

<h2 id="In-place-editing-is-now-safer">In-place editing is now safer</h2>

<p>Previously in-place editing would delete or rename the input file as soon as you started working on a new file.</p>

<p>Without backups this would result in loss of data if there was an error, such as a full disk, when writing to the output file.</p>

<p>This has changed so that the input file isn&#39;t replaced until the output file has been completely written and successfully closed.</p>

<p>This works by creating a work file in the same directory, which is renamed over the input file once the output file is complete.</p>

<p>Incompatibilities:</p>

<ul>

<li><p>Since this renaming needs to only happen once, if you create a thread or child process, that renaming will only happen in the original thread or process.</p>

</li>
<li><p>If you change directories while processing a file, and your operating system doesn&#39;t provide the <code>unlinkat()</code>, <code>renameat()</code> and <code>fchmodat()</code> functions, the final rename step may fail.</p>

</li>
</ul>

<p><a href="https://rt.perl.org/Public/Bug/Display.html?id=127663">[perl #127663]</a></p>

<h2 id="Initialisation-of-aggregate-state-variables">Initialisation of aggregate state variables</h2>

<p>A persistent lexical array or hash variable can now be initialized, by an expression such as <code>state @a = qw(x y z)</code>. Initialization of a list of persistent lexical variables is still not possible.</p>

<h2 id="Full-size-inode-numbers">Full-size inode numbers</h2>

<p>On platforms where inode numbers are of a type larger than perl&#39;s native integer numerical types, <a href="/cperl/perlfunc.html#stat">stat</a> will preserve the full content of large inode numbers by returning them in the form of strings of decimal digits. Exact comparison of inode numbers can thus be achieved by comparing with <code>eq</code> rather than <code>==</code>. Comparison with <code>==</code>, and other numerical operations (which are usually meaningless on inode numbers), work as well as they did before, which is to say they fall back to floating point, and ultimately operate on a fairly useless rounded inode number if the real inode number is too big for the floating point format.</p>

<h2 id="Changed-warnings::register-handling-of-all">Changed warnings::register handling of all</h2>

<p>If a scope used &quot;use warnings &#39;all&#39;&quot; to turn on all warnings and then turned off some specific warnings, then that scope wouldn&#39;t get warnings for subsequently-registered warning categories, because its bitset doesn&#39;t extend to the bit controlling the new category.</p>

<p>Unlike all other warning categories, the bits for &quot;all&quot; used to be set only when there were no warning categories disabled; disabling any would also clear the &quot;all&quot; bits. That was supporting the dynamic nature of warnings::register extending the all-warnings bitset for new categories. This exception is now removed, so the meaning of the &quot;all&quot; bits is now the more obvious meaning, of indicating the default treatment that the scope wants for warnings not falling into any category known to the bitset. In <code>warnings::warnif()</code> et al, if the caller&#39;s bitset is found to be too short to have a bit for the relevant category, then the setting for the &quot;all&quot; category is used instead.</p>

<p>Because the length of a bitset is an integral number of bytes, but only two bits are used per category, the length of a bitset doesn&#39;t precisely indicate which categories had been registered by the time it was constructed. So the standard bitsets for the &quot;all&quot; category are now always filled to their byte length, with bits set preemptively for categories not yet registered that fall within the current bitset length.</p>

<p>When a warnings pragma operates on a bitset, it first expands it to the preferred length, by duplicating the &quot;all&quot; bits for the categories covered by the new length. It is careful to maintain the length when combining the bitset with the standard bitsets for categories. When a bitset is read from <code>${^WARNING_BITS}</code> or from <code>caller()</code>, the standard <code>pWARN_ALL</code> setting is no longer expanded by the core to <code>$warnings::Bits{all}</code>, because the core&#39;s short <code>WARN_ALLstring</code> will now be expanded correctly just like any other bitset.</p>

<p>Fixes <a href="https://rt.perl.org/Public/Bug/Display.html?id=108778">[perl #108778]</a></p>

<h1 id="Security">Security</h1>

<h2 id="CVE-2017-12837-Heap-buffer-overflow-in-regular-expression-compiler">[CVE-2017-12837] Heap buffer overflow in regular expression compiler</h2>

<p>Compiling certain regular expression patterns with the case-insensitive modifier could cause a heap buffer overflow and crash perl. This has now been fixed. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131582">[perl #131582]</a></p>

<h2 id="CVE-2017-12883-Buffer-over-read-in-regular-expression-parser">[CVE-2017-12883] Buffer over-read in regular expression parser</h2>

<p>For certain types of syntax error in a regular expression pattern, the error message could either contain the contents of a random, possibly large, chunk of memory, or could crash perl. This has now been fixed. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131598">[perl #131598]</a></p>

<h2 id="CVE-2017-12814-ENV-key-stack-buffer-overflow-on-Windows">[CVE-2017-12814] <code>$ENV{$key}</code> stack buffer overflow on Windows</h2>

<p>A possible stack buffer overflow in the <code>%ENV</code> code on Windows has been fixed by removing the buffer completely since it was superfluous anyway. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131665">[perl #131665]</a></p>

<h2 id="Unsigned-long-stack-access-of-printf-format-arguments">Unsigned long stack access of printf format arguments</h2>

<p>perl 5.27.5 started allowing unsigned long/4 stack indices for its sv arguments, and width and precision with the API even allowing <code>unsigned long</code>. Previously those numbers were safely typed to <code>int</code>. Revert that security problem in cperl. The maximal width and precision is also back to INT_MAX. See <a href="https://github.com/perl11/cperl/issues/344">[cperl #344]</a></p>

<h1 id="Incompatible-Changes">Incompatible Changes</h1>

<h2 id="Comma-less-variable-lists-in-formats-are-no-longer-allowed">Comma-less variable lists in formats are no longer allowed</h2>

<p>Omitting the commas between variables passed to formats is no longer allowed. This has been deprecated since perl 5.000.</p>

<h2 id="The-:locked-and-:unique-attributes-have-been-removed">The <code>:locked</code> and <code>:unique</code> attributes have been removed</h2>

<p>These have been no-ops and deprecated since perl 5.12 and 5.10, respectively.</p>

<h2 id="N-with-nothing-between-the-braces-is-now-illegal"><code>\N{}</code> with nothing between the braces is now illegal.</h2>

<p>This has been deprecated since Perl 5.24.</p>

<h2 id="Opening-the-same-symbol-as-both-a-file-and-directory-handle-is-no-longer-allowed">Opening the same symbol as both a file and directory handle is no longer allowed</h2>

<p>Using <a href="/cperl/perlfunc.html#open-FILEHANDLE-EXPR">open()</a> and <a href="/pod/perlfunc.html#opendir-DIRHANDLE-EXPR">opendir()</a> to associate both a filehandle and a dirhandle to the same symbol (glob or scalar) has been deprecated since Perl 5.10.</p>

<h2 id="Use-of-bare-to-mean-is-no-longer-allowed">Use of bare <code>&lt;&lt;</code> to mean <code>&lt;&lt;&quot;&quot;</code> is no longer allowed</h2>

<p>Use of a bare terminator has been deprecated since Perl 5.000.</p>

<h2 id="Setting-to-a-reference-to-a-non-positive-integer-no-longer-allowed">Setting $/ to a reference to a non-positive integer no longer allowed</h2>

<p>This used to work like setting it to <code>undef</code>, but has been deprecated since Perl 5.20.</p>

<h2 id="Unicode-code-points-with-values-exceeding-IV_MAX-are-now-fatal">Unicode code points with values exceeding <code>IV_MAX</code> are now fatal.</h2>

<p>This was deprecated since Perl 5.24.</p>

<h2 id="B::OP::terse-no-longer-exists"><code>B::OP::terse</code> no longer exists.</h2>

<p>Use <code>B::Concise::b_terse</code> instead.</p>

<h2 id="Use-of-inherited-AUTOLOAD-for-non-methods-is-no-longer-allowed">Use of inherited AUTOLOAD for non-methods is no longer allowed.</h2>

<p>This was deprecated in Perl 5.004.</p>

<h2 id="Use-of-strings-with-code-points-over-0xFF-is-not-allowed-for-bitwise-string-operators">Use of strings with code points over 0xFF is not allowed for bitwise string operators</h2>

<p>Code points over 0xFF do not make sense for bitwise operators.</p>

<h2 id="Backslash-no-longer-escapes-colon-in-PATH-for-the--S-switch">Backslash no longer escapes colon in PATH for the -S switch</h2>

<p>Previously the <code>-S</code> switch incorrectly treated backslash (&quot;\&quot;) as an escape for colon when traversing the <code>PATH</code> environment variable. <a href="https://rt.perl.org/Ticket/Display.html?id=129183">[perl #129183]</a></p>

<h2 id="Subroutines-no-longer-need-typeglobs">Subroutines no longer need typeglobs</h2>

<p>Perl 5.22.0 introduced an optimization allowing subroutines to be stored in packages as simple sub refs, not requiring a full typeglob (thus potentially saving large amounts of memeory). However, the optimization was flawed: it only applied to the main package.</p>

<p>This optimization has now been extended to all packages. This may break compatibility with introspection code that looks inside stashes and expects everything in them to be a typeglob.</p>

<p>When this optimization happens, the typeglob still notionally exists, so accessing it will cause the stash entry to be upgraded to a typeglob. The optimization does not apply to XSUBs or exported subroutines, and calling a method will undo it, since method calls cache things in typeglobs.</p>

<h2 id="is-a-term-in-cperl-not-a-statement">... is a term in cperl, not a statement</h2>

<p>perl5.27.6 restricted <code>...</code>, the yada-yada operator, to be a statement only. cperl reserved <code>...</code> for the ellipsis, i.e. unassigned varargs in signatures to be passed through. Which is not a statement, but a term. In cperl <code>...</code> is a TERM. Before <code>...</code> was parsed as an operator, also used for ranges.</p>

<p>This affects illegal code like:</p>

<pre><code>    ... . &quot;foo&quot;;
    ... if $a &lt; $b;
    do{...}</code></pre>

<h1 id="Deprecations">Deprecations</h1>

<h2 id="Use-of-1-perlfunc-vec-EXPR-OFFSET-BITS-on-strings-with-code-points-above-0xFF-is-deprecated">Use of <a>$1</a>|perlfunc/vec EXPR,OFFSET,BITS&gt; on strings with code points above 0xFF is deprecated.</h2>

<p>Use of these is nonsensical, as <code>vec</code> is a bit-oriented operation, which operates on the underlying UTF-8 representation these strings must be in, and will likely give unexpected results.</p>

<h2 id="Some-uses-of-unescaped-are-no-longer-fatal">Some uses of unescaped <code>&quot;{&quot;</code> are no longer fatal</h2>

<p>Perl 5.26.0 fatalized some uses of an unescaped left brace, but an exception was made at the last minute, specifically crafted to be a minimal change to allow GNU Autoconf to work. This code is heavily depended upon, and continues to use the deprecated usage. Its use of an unescaped left brace is one where we have no intention of repurposing <code>&quot;{&quot;</code> to be something other than itself.</p>

<p>That exception is now generalized to include various other such cases where the <code>&quot;{&quot;</code> will not be repurposed. This is to get real experience with this more complicated change now, in case we need to issue a dot release if we find other things like Autoconf that are important to work around.</p>

<p>Note that these uses continue to raise a deprecation message.</p>

<h2 id="Module-removals">Module removals</h2>

<p>The following modules will be removed from the core distribution in a future release, and will at that time need to be installed from CPAN. Distributions on CPAN which require these modules will need to list them as prerequisites.</p>

<p>The core versions of these modules will now issue <code>&quot;deprecated&quot;</code>-category warnings to alert you to this fact. To silence these deprecation warnings, install the modules in question from CPAN.</p>

<p>Note that these are (with rare exceptions) fine modules that you are encouraged to continue to use. Their disinclusion from core primarily hinges on their necessity to bootstrapping a fully functional, CPAN-capable Perl installation, not usually on concerns over their design.</p>

<dl>

<dt id="Locale::Codes"><a>Locale::Codes</a></dt>
<dd>

</dd>
</dl>

<h1 id="Performance-Enhancements">Performance Enhancements</h1>

<ul>

<li><p>The <a>fields</a> API refactor using a local <a href="/cperl/perlapi.html#HvFIELDS">&quot;HvFIELDS&quot; in perlapi</a> buffer and not globals <code>%FIELDS</code> and <code>@FIELDS</code> SVs anymore gained 25% speed and similar memory improvements. cperl-only.</p>

</li>
<li><p>Optimize field method calls to faster oelemfast OPs, accessing the field directly. cperl-only.</p>

</li>
<li><p>Removed <code>PL_sv_count</code> variable and updates on every <code>new_SV</code> and <code>del_SV</code> on non-DEBUGGING builds. For refcount leak checks scan the arenas. cperl-only.</p>

</li>
<li><p><code>SvTRUE()</code> is now more efficient.</p>

</li>
<li><p><code>keys()</code> in void and scalar contexts is now more efficient.</p>

</li>
<li><p>Various integer-returning ops are now more efficient in scalar/boolean context.</p>

</li>
<li><p><code>if (index(...) != -1) { ... }</code> is now more efficient.</p>

</li>
<li><p>Slightly improved performance when parsing stash names. <a href="https://rt.perl.org/Public/Bug/Display.html?id=129990">[perl #129990]</a></p>

</li>
<li><p>Calls to <code>require</code> for an already loaded module are now slightly faster. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132171">[perl #132171]</a></p>

</li>
<li><p>Many string concatenation expressions are now considerably faster, due to the introduction internally of a <code>multiconcat</code> opcode which combines multiple concatenations, and optionally a <code>=</code> or <code>.=</code>, into a single action. For example, apart from retrieving <code>$s</code>, <code>$a</code> and <code>$b</code>, this whole expression is now handled as a single op:</p>

<pre><code>    $s .= &quot;a=$a b=$b\n&quot;</code></pre>

<p>As a special case, if the LHS of an assign is a lexical variable or <code>my $s</code>, the op itself handles retrieving the lexical variable, which is faster.</p>

<p>In general, the more the expression includes a mix of constant strings and variable expressions, the longer the expression, and the more it mixes together non-utf8 and utf8 strings, the more marked the performance improvement. For example on a <code>x86_64</code> system, this code has been benchmarked running four times faster:</p>

<pre><code>    my $s;
    my $a = &quot;ab\x{100}cde&quot;;
    my $b = &quot;fghij&quot;;
    my $c = &quot;\x{101}klmn&quot;;

    for my $i (1..10_000_000) {
        $s = &quot;\x{100}wxyz&quot;;
        $s .= &quot;foo=$a bar=$b baz=$c&quot;;
    }</code></pre>

<p>In addition, <code>sprintf</code> expressions which have a constant format containing only <code>%s</code> and <code>%%</code> format elements, and which have a fixed number of arguments, are now also optimised into a <code>multiconcat</code> op.</p>

</li>
<li><p>Subroutines in packages no longer need to be stored in typeglobs, saving large amounts of memory. See <a href="#Subroutines-no-longer-need-typeglobs">&quot;Subroutines no longer need typeglobs&quot;</a> under <a href="#Incompatible-Changes">&quot;Incompatible Changes&quot;</a>, above.</p>

</li>
</ul>

<h1 id="Modules-and-Pragmata">Modules and Pragmata</h1>

<h2 id="Removal-of-use-vars">Removal of use vars</h2>

<p>The usage of <code>use vars</code> has been discouraged since the introduction of <code>our</code> in Perl 5.6.0. Where possible the usage of this pragma has now been removed from the Perl source code.</p>

<p>This had a slight effect (for the better) on the output of <code>WARNING_BITS</code> in <a>B::Deparse</a>.</p>

<p>Several core modules released on CPAN will not work anymore with perl versions prior to 5.6.</p>

<h2 id="Updated-Modules-and-Pragmata">Updated Modules and Pragmata</h2>

<dl>

<dt id="arybase-0.14"><a>arybase</a> 0.14</dt>
<dd>

<p>Remove #ifdef USE_ITHREADS around MUTEX_* calls</p>

</dd>
<dt id="attributes-1.14c"><a>attributes</a> 1.14c</dt>
<dd>

<p>Remove deprecated no-op attributes :unique, :locked. Added another param to validate_proto.</p>

</dd>
<dt id="Attribute::Handlers-1.00"><a>Attribute::Handlers</a> 1.00</dt>
<dd>

<p>Remove deprecated no-op attributes :unique, :locked</p>

</dd>
<dt id="base-2.27c"><a>base</a> 2.27c</dt>
<dd>

<p>Limit dotless-INC effect on base.pm with guard</p>

</dd>
<dt id="B-1.71_08"><a>B</a> 1.71_08</dt>
<dd>

<p>Support PL_sv_zero</p>

</dd>
<dt id="B::C-1.55_06"><a>B::C</a> 1.55_06</dt>
<dd>

<p>Support POK/PVLV REGEXP for v5.27.3/v5.27.2c VOL =&gt; volatile for v5.27.6/v5.27.2c</p>

</dd>
<dt id="B::Concise-1.003c"><a>B::Concise</a> 1.003c</dt>
<dd>

<p>Support PL_sv_zero</p>

</dd>
<dt id="B::Deparse-1.43_04c"><a>B::Deparse</a> 1.43_04c</dt>
<dd>

<p>Support boolean optims. Better constant-dumping heuristics.</p>

</dd>
<dt id="B::Terse-1.09_01"><a>B::Terse</a> 1.09_01</dt>
<dd>

<p>Remove internal links to B::Debug</p>

</dd>
<dt id="B::Xref-1.07_01"><a>B::Xref</a> 1.07_01</dt>
<dd>

<p>Support sub refs</p>

</dd>
<dt id="Carp-1.44c"><code>Carp</code> 1.44c</dt>
<dd>

<p>Fix problems introduced by the partial EBCDIC support from version 1.35, and ISA constants. Not all stash elements are globs.</p>

</dd>
<dt id="charnames-1.45"><code>charnames</code> 1.45</dt>
<dd>

<p>Remove obsolete pod about NBSP</p>

</dd>
<dt id="Compress::Raw::Zlib-2.076"><a>Compress::Raw::Zlib</a> 2.076</dt>
<dd>

<p>Updated internal zlib from 1.2.8 to 1.2.11</p>

<p>Silence gcc compiler warnings when -Wsign-compare is enabled #123688: Compilation warnings with clang</p>

<p>Silence gcc compiler warnings when -Wimplicit-fallthrough is enabled #123358: Compilation warnings with gcc-7.*</p>

<p>Windows uses -lzlib. Linux uses -lz #123699: wrong external zlib name used on Windows</p>

<p>Update zlib-src directory to use zlib 1.2.11 #123245: perl 5.26.1 is vulnerable to CVE-2016-9843, CVE-2016-9841, CVE-2016-9840, CVE-2016-9842</p>

<p>Don&#39;t allow offset to be greater than length of buffer in crc32.</p>

<p>Change my_zcalloc to use safecalloc. The link, https://github.com/madler/zlib/issues/253, is the upstream report for the remaining valgrind errors not already dealt with by 1.2.11. Using calloc in Zlib.xs for now as a workaround. #121074: valgrind errors in the test suite</p>

</dd>
<dt id="Config::Perl::V-0.29_01"><a>Config::Perl::V</a> 0.29_01</dt>
<dd>

<pre><code>    * Add test for 5.26.1-RC1, and some cperl -V&#39;s
    * Fix signature with argument
    * Ignore ccache and compiler path in signature

    * Add default_inc_excludes_dot</code></pre>

</dd>
<dt id="constant-1.34"><code>constant</code> 1.34</dt>
<dd>

</dd>
<dt id="coretypes-0.03c"><code>coretypes</code> 0.03c</dt>
<dd>

<p>Each coretype is now a class.</p>

</dd>
<dt id="Cpanel::JSON::XS-3.0239"><a>Cpanel::JSON::XS</a> 3.0239</dt>
<dd>

<p>Fixed locale-insensitive numeric conversion on older perls. Fixed compilation under windows.</p>

</dd>
<dt id="Data::Dumper-2.167_02"><a>Data::Dumper</a> 2.167_02</dt>
<dd>

<p>Attempt to work around XS deparse issues on old perls.</p>

</dd>
<dt id="Devel::Peek-1.27_03"><a>Devel::Peek</a> 1.27_03</dt>
<dd>

<p>Dump the values of a COP $^H, %^H and lexical warnings. Improved the test a bit.</p>

<p>use cv_set_call_checker_flags</p>

</dd>
<dt id="Devel::PPPort-3.36_03"><a>Devel::PPPort</a> 3.36_03</dt>
<dd>

<p>Silence PERL_CORE make</p>

</dd>
<dt id="Digest::SHA-5.98"><a>Digest::SHA</a> 5.98</dt>
<dd>

<p>Remove deprecated -p option</p>

</dd>
<dt id="DirHandle-1.05"><a>DirHandle</a> 1.05</dt>
<dd>

<p>Document as obsolete</p>

</dd>
<dt id="Encode-2.93"><a>Encode</a> 2.93</dt>
<dd>

<p>lib/Encode/MIME/Name.pm t/mime-name.t Pulled: Add &quot;euc-cn&quot; =&gt; &quot;EUC-CN&quot; alias to Encode::MIME::Name https://github.com/dankogai/p5-encode/pull/124</p>

<p>lib/Encode/CN/HZ.pm lib/Encode/JP/JIS7.pm lib/Encode/MIME/Header.pm t/decode.t Pulled: Uninitialized value fixes #122 https://github.com/dankogai/p5-encode/pull/122</p>

<p>Makefile.PL Pulled: Fix -Werror=declaration-after-statement for gcc 4.1.2 https://github.com/dankogai/p5-encode/pull/121</p>

</dd>
<dt id="experimental-0.019_01c"><a>experimental</a> 0.019_01c</dt>
<dd>

<p>eval use feature, minor test fix.</p>

</dd>
<dt id="ExtUtils::Constant-0.24_01"><a>ExtUtils::Constant</a> 0.24_01</dt>
<dd>

<p>Minor updates from p5p</p>

</dd>
<dt id="ExtUtils::CBuilder-0.280230"><a>ExtUtils::CBuilder</a> 0.280230</dt>
<dd>

<p>use vars =&gt; our</p>

</dd>
<dt id="ExtUtils::Install-2.14"><a>ExtUtils::Install</a> 2.14</dt>
<dd>

<p>Minor updates, some taken from cperl.</p>

</dd>
<dt id="ExtUtils::ParseXS-3.26_02"><a>ExtUtils::ParseXS</a> 3.26_02</dt>
<dd>

</dd>
<dt id="feature-1.49_01"><a>feature</a> 1.49_01</dt>
<dd>

</dd>
<dt id="fields-2.26c"><a>fields</a> 2.26c</dt>
<dd>

<p>Implemented <a>&quot;fields&quot; in Mu</a> returning fields objects, as in perl6 (there called <i>Attributes</i>).</p>

<p>Revert the conversion of a fields package to class. Only close the ISA as with base.</p>

<p>cperl-only.</p>

</dd>
<dt id="File::Fetch-0.56"><a>File::Fetch</a> 0.56</dt>
<dd>

<p>Switch test URL from www.cpan.org to httpbin.org</p>

</dd>
<dt id="File::Glob-1.30"><a>File::Glob</a> 1.30</dt>
<dd>

<p>Skip a test when File::Glob not used. Avoid undefined behaviour in Copy() [perl #131746]</p>

</dd>
<dt id="Filter::Util::Call-1.58"><a>Filter::Util::Call</a> 1.58</dt>
<dd>

<p>XSLoader, our. defer Carp. add filter_read_exact tests.</p>

</dd>
<dt id="GDBM_File-1.16"><a>GDBM_File</a> 1.16</dt>
<dd>

<p>Add a pod link</p>

</dd>
<dt id="Hash::Util::FieldHash-1.20"><a>Hash::Util::FieldHash</a> 1.20</dt>
<dd>

</dd>
<dt id="I18N::Langinfo-0.14"><a>I18N::Langinfo</a> 0.14</dt>
<dd>

<p>Use new fcn Perl_langinfo()</p>

</dd>
<dt id="if-0.0607"><a>if</a> 0.0607</dt>
<dd>

<p>Doc how to import when you want to &#39;use MODULE ()&#39;</p>

</dd>
<dt id="IO::Handle-1.37"><a>IO::Handle</a> 1.37</dt>
<dd>

</dd>
<dt id="JSON::PP-2.97000_04"><a>JSON::PP</a> 2.97000_04</dt>
<dd>

<p>Minor updates, mostly docs. Upstream Boolean still did not work with Cpanel::JSON::XS.</p>

</dd>
<dt id="libnet-3.11_01"><code>libnet</code> 3.11_01</dt>
<dd>

</dd>
<dt id="Locale::Codes-3.55"><a>Locale::Codes</a> 3.55</dt>
<dd>

<p>Deprecate from core with v5.27.7, move to cpan.</p>

</dd>
<dt id="Module::CoreList-20170815c"><a>Module::CoreList</a> 20170815c</dt>
<dd>

</dd>
<dt id="Module::Load::Conditional-0.68_01"><a>Module::Load::Conditional</a> 0.68_01</dt>
<dd>

<p>Improve CPANPLUS: Fix [cperl #331], checking for cperl builtins. With a slightly adjusted patch from @voegelas.</p>

</dd>
<dt id="mro-1.21"><a>mro</a> 1.21</dt>
<dd>

<p>prevent mro.pm from loading DynaLoader</p>

</dd>
<dt id="Mu-0.02c"><a>Mu</a> 0.02c</dt>
<dd>

<p>Implemented <a>&quot;fields&quot; in Mu</a> returning fields objects. cperl-only.</p>

</dd>
<dt id="Net::Ping-2.63"><a>Net::Ping</a> 2.63</dt>
<dd>

<p>Keep v5.002 - v5.6 support</p>

<p>Removed outdated demo/fping from the documentation (RT #123750 by Steve Morris)</p>

<p>Added t/420_ping_syn_port.t (#4 by Julio Fraire) with fixes.</p>

<p>Added indices and crosslinks to the documentation</p>

</dd>
<dt id="NEXT-0.67_01"><a>NEXT</a> 0.67_01</dt>
<dd>

<p>Fix for GLOB stubs [cpan #123002].</p>

</dd>
<dt id="O-1.03"><a>O</a> 1.03</dt>
<dd>

<p>Improve error message for bogus -MO=&hellip; arguments</p>

</dd>
<dt id="ODBM_File-1.15"><a>ODBM_File</a> 1.15</dt>
<dd>

</dd>
<dt id="Opcode-1.40_02c"><a>Opcode</a> 1.40_02c</dt>
<dd>

</dd>
<dt id="perl5db-1.52_01c"><a>perl5db</a> 1.52_01c</dt>
<dd>

<p>Support debugger cmds not requiring spaces</p>

</dd>
<dt id="PerlIO::scalar-0.29"><a>PerlIO::scalar</a> 0.29</dt>
<dd>

<p>check invariant at compile time.</p>

<p>return EACCES on writing to a read-only scalar</p>

</dd>
<dt id="Pod::HTML-2.2303c"><a>Pod::HTML</a> 2.2303c</dt>
<dd>

</dd>
<dt id="Pod::Perldoc-3.2801"><a>Pod::Perldoc</a> 3.2801</dt>
<dd>

<p>customize to fix formatters and pager misbehaviour</p>

</dd>
<dt id="POSIX-1.78_03"><a>POSIX</a> 1.78_03</dt>
<dd>

<p>internal cleanup of setlocale (unusable for cpan). get/setpriority constants</p>

</dd>
<dt id="re-0.35_01"><a>re</a> 0.35_01</dt>
<dd>

<p>Faster. add DEBUGGING_RE_ONLY define</p>

</dd>
<dt id="SelfLoader-1.24"><a>SelfLoader</a> 1.24</dt>
<dd>

</dd>
<dt id="Scalar::Util-2.49_09"><a>Scalar::Util</a> 2.49_09</dt>
<dd>

<p>fix find_rundefsvoffset logic Fix t/subname.t for unstrict names perl5.26 started defining $Config{usecperl} as &#39;UNKNOWN&#39;, hence this check is now unreliable.</p>

<p>Merge with 1.49 upstream: Ensure pairmap extends its stack correctly (davem) Fix name of List::Util::unpairs in its error messages</p>

</dd>
<dt id="sort-2.03"><a>sort</a> 2.03</dt>
<dd>

<p>no sort stable; SORTf_UNSTABLE flag</p>

</dd>
<dt id="Storable-3.05_16"><a>Storable</a> 3.05_16</dt>
<dd>

<p>Try to fix readonly stacksize.h with perlbrew. [cperl #335]</p>

<p>Fix t/blessed.t for 5.10/5.12 threaded.</p>

<p>Restore max stacksizes for non-windows systems with proper system(SHELLSTRING) passing signals. Unify stack reserve to 32 across all platforms.</p>

</dd>
<dt id="Symbol-1.08_01"><a>Symbol</a> 1.08_01</dt>
<dd>

<p>Improved Symbol::delete_package for readonly and protected symbols and classes.</p>

</dd>
<dt id="Term::ReadLine-1.17"><a>Term::ReadLine</a> 1.17</dt>
<dd>

<p>fix for empty &amp;STDERR files RT #132008</p>

</dd>
<dt id="threads-2.18_01"><a>threads</a> 2.18_01</dt>
<dd>

<p>Support PL_sv_zero. Don&#39;t Copy() null pointer</p>

</dd>
<dt id="Time::Piece-1.3202"><a>Time::Piece</a> 1.3202</dt>
<dd>

<pre><code>    - Fix AIX compile
    - Fix compile errors on MS
    - Use macro for buf sizes
    - Remove some compile warnings
    - SP off by 1 in _crt_localtime</code></pre>

</dd>
<dt id="Time::HiRes-1.9747_01"><a>Time::HiRes</a> 1.9747_01</dt>
<dd>

<p>Drop 5.005 support. Replace DynaLoader with XSLoader.</p>

</dd>
<dt id="Unicode::Collate-1.25"><a>Unicode::Collate</a> 1.25</dt>
<dd>

<p>Drop 5.005 support. Replace DynaLoader with XSLoader.</p>

</dd>
<dt id="Unicode::Normalize-1.26"><a>Unicode::Normalize</a> 1.26</dt>
<dd>

<p>Switch to XSLoader from Dynaloader</p>

</dd>
<dt id="utf8-2.02c"><a>utf8</a> 2.02c</dt>
<dd>

<p>Improved function documentation</p>

</dd>
<dt id="version-0.9918_02c"><a>version</a> 0.9918_02c</dt>
<dd>

<p>Add updates from 0.9918: Add LAX_DECIMAL_VERSION, LAX_DOTTED_DECIMAL_VERSION, STRICT_DECIMAL_VERSION, STRICT_DOTTED_DECIMAL_VERSION regexes.</p>

<p>Add <i>t/11_taint.t</i></p>

</dd>
<dt id="VMS::Stdio-2.44_01"><a>VMS::Stdio</a> 2.44_01</dt>
<dd>

<p>Drop VMS::stdio compatibility shim</p>

</dd>
<dt id="XS::APITest-0.92_02"><a>XS::APITest</a> 0.92_02</dt>
<dd>

</dd>
<dt id="XS::Typemap-0.16"><a>XS::Typemap</a> 0.16</dt>
<dd>

</dd>
</dl>

<h2 id="Removed-Modules-and-Pragmata">Removed Modules and Pragmata</h2>

<dl>

<dt id="B::Debug-1.25">B::Debug 1.25</dt>
<dd>

<p>Moved to CPAN. cperl only. perl5 will remove it with 5.30.</p>

</dd>
</dl>

<h1 id="Documentation">Documentation</h1>

<h2 id="New-Documentation">New Documentation</h2>

<h3 id="PACKAGING"><a>PACKAGING</a></h3>

<p>Notes and best practice for packaging perl 5</p>

<h2 id="Changes-to-Existing-Documentation">Changes to Existing Documentation</h2>

<h3 id="perlapi"><a href="/cperl/perlapi.html">perlapi</a></h3>

<ul>

<li><p>Added API docs for most hash macros.</p>

</li>
</ul>

<h3 id="perlop"><a href="/cperl/perlop.html">perlop</a></h3>

<ul>

<li><p>Added the missing operator precedences and documentation for the cperl unicode operators.</p>

</li>
<li><p><a href="/cperl/perlop.html">perlop</a> has been updated to note that <code>qw</code>&#39;s whitespace rules differ from that of <code>split</code>&#39;s in that only ASCII whitespace is used.</p>

</li>
</ul>

<h3 id="perldata"><a href="/cperl/perldata.html">perldata</a></h3>

<ul>

<li><p>The section &quot;Truth and Falsehood&quot; in <a href="/cperl/perlsyn.html">perlsyn</a> has been removed from that document, where it didn&#39;t belong, and merged into the existing paragraph on the same topic in <a href="/pod/perldata.html">perldata</a>.</p>

</li>
</ul>

<h3 id="perluniprops"><a href="/cperl/perluniprops.html">perluniprops</a></h3>

<ul>

<li><p><a href="/cperl/perluniprops.html">perluniprops</a> has been updated to note that <code>\p{Word}</code> now includes code points matching the <code>\p{Join_Control}</code> property. The change to the property was made in Perl 5.18, but not documented until now. There are currently only two code points that match this property U+200C (ZERO WIDTH NON-JOINER) and U+200D (ZERO WIDTH JOINER).</p>

</li>
</ul>

<h3 id="perlintern"><a href="/cperl/perlintern.html">perlintern</a></h3>

<ul>

<li><p>Added API docs for most toke.c lexer functions.</p>

</li>
</ul>

<h3 id="perlfilter"><a href="/cperl/perlfilter.html">perlfilter</a></h3>

<ul>

<li><p>Add warning about raw <code>?...?</code> pattern delimiters.</p>

</li>
</ul>

<h3 id="POSIX"><a>POSIX</a></h3>

<ul>

<li><p><a>POSIX</a> has been updated with some more cautions about using locale-specific functions in threaded applications.</p>

</li>
</ul>

<h1 id="Diagnostics">Diagnostics</h1>

<p>The following additions or changes have been made to diagnostic output, including warnings and fatal error messages. For the complete list of diagnostic messages, see <a href="/cperl/perldiag.html">perldiag</a>.</p>

<h2 id="New-Diagnostics">New Diagnostics</h2>

<h3 id="New-Errors">New Errors</h3>

<ul>

<li><p><a href="/cperl/perldiag.html#Cannot-complete-in-place-edit-of-s:-s">Cannot complete in-place edit of %s: %s</a> when an unhandled chdir happens during an in-place edit.</p>

</li>
<li><p><a href="/cperl/perldiag.html#Can-t-rename-in-place-work-file-s-to-s-:-s">Can&#39;t rename in-place work file &#39;%s&#39; to &#39;%s&#39;: %s</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Can-t-unweaken-a-nonreference">Can&#39;t unweaken a nonreference</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Missing-argument-for-n-in-s">Missing argument for %n in %s</a> in sprintf is now fatal.</p>

</li>
<li><p><a href="/cperl/perldiag.html#Integer-overflow-in-format-string-for-s">Integer overflow in format string for %s</a></p>

<p>cperl 5.27.2 added a new limitation of INT_MAX to the max. argument index, width and precision values for printf format strings. The new perl5.27.5 limitation is ULONG_MAX, which is a security risk, see <a href="#Unsigned-long-stack-access-of-printf-format-arguments">&quot;Unsigned long stack access of printf format arguments&quot;</a>.</p>

</li>
<li><p><a href="/cperl/perldiag.html#Too-large-floating-point-precision-in-format-string-s-for-s">Too large floating point precision in format string %s for %s</a></p>

<p>cperl 5.27.2 added a new limitation of 1024 to the max. precision of floating point conversions to strings via sprintf, to seperate it from Integer overflows in overlarge indices, width and precision values.</p>

</li>
<li><p><a href="/cperl/perldiag.html#Too-many-fields">Too many fields</a></p>

<p>cperl 5.27.2 added a new limitation of max. 65536 fields per class.</p>

</li>
<li><p><code>panic: cannot yet adjust field indices when composing role %s::%s into %s %s [cperl #311]&quot;</code></p>

<p>When copying a method from a role to a class, and the field index from the role method would be different to a field index in the resulting class, the method is not yet fixed up to the new indices. A temp. solution would be to change the ordering of the roles, or to use the <code>$self-&gt;field</code> method syntax in the role method. This should be fixed before 5.28. Currently we can only alias composed role methods and we don&#39;t change the ordering of the fields. See <a href="https://github.com/perl11/cperl/issues/311">[cperl #311]</a></p>

</li>
<li><p><a href="/cperl/perldiag.html#Invalid-field-index-d-of-s-s">Invalid field index %d of class %s</a></p>

<p>The class doesn&#39;t have that many fields. cperl only</p>

</li>
</ul>

<h3 id="New-Warnings">New Warnings</h3>

<ul>

<li><p><a href="/cperl/perldiag.html#Reference-is-not-weak">Reference is not weak</a> in W misc.</p>

</li>
</ul>

<h2 id="Changes-to-Existing-Diagnostics">Changes to Existing Diagnostics</h2>

<ul>

<li><p>A false-positive warning that was issued when using a numerically-quantified sub-pattern in a recursive regex has been silenced. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131868">[perl #131868]</a></p>

</li>
<li><p>The diagnostic <code>Initialization of state variables in list context currently forbidden</code> has changed to <code>Initialization of state variables in list currently forbidden</code>, because list-context initialization of single aggregate state variables is now permitted.</p>

</li>
<li><p><code>Failed to close in-place edit file %s: %s</code> was renamed to <a href="/cperl/perldiag.html#Failed-to-close-in-place-work-file-s:-s">Failed to close in-place work file %s: %s</a>.</p>

</li>
<li><p><code>delete argument is index/value array slice, use array slice</code> and <code>delete argument is key/value hash slice, use hash slice</code> is gone, deleting key/value slices is now supported.</p>

</li>
</ul>

<h1 id="Configuration-and-Compilation">Configuration and Compilation</h1>

<dl>

<dt id="C89-requirement">C89 requirement</dt>
<dd>

<p>Perl has been documented as requiring a C89 compiler to build since October 1998. A variety of simplifications have now been made to Perl&#39;s internals to rely on the features specified by the C89 standard. We believe that this internal change hasn&#39;t altered the set of platforms that Perl builds on, but please report a bug if Perl now has new problems building on your platform.</p>

</dd>
<dt id="Werror-pointer-arith">-Werror=pointer-arith</dt>
<dd>

<p>With GCC, <code>-Werror=pointer-arith</code> is now enabled by default, disallowing arithmetic on void and function pointers.</p>

</dd>
<dt id="d_builtin_arith_overflow">d_builtin_arith_overflow</dt>
<dd>

<p>Fixed <code>d_builtin_arith_overflow</code> detection and usage for 32bit systems with <code>use64bitint</code>. They do use the <code>ll</code> suffix, same as with WIN64. Now we can use this optimization. cperl-only.</p>

</dd>
<dt id="New-probes">New probes</dt>
<dd>

<p>Note that cperl ignores the new <code>HAS_BUILTIN_{ADD,MUL,SUB}_OVERFLOW</code> config keys as we use the better <code>HAS_BUILTIN_ARITH_OVERFLOW</code> for years already.</p>

<dl>

<dt id="HAS_THREAD_SAFE_NL_LANGINFO_L">HAS_THREAD_SAFE_NL_LANGINFO_L</dt>
<dd>

<p>d_thread_safe_nl_langinfo_l</p>

</dd>
<dt id="HAS_LOCALECONV_L">HAS_LOCALECONV_L</dt>
<dd>

<p>d_localeconv_l</p>

</dd>
<dt id="HAS_MBRLEN">HAS_MBRLEN</dt>
<dd>

<p>d_mbrlen</p>

</dd>
<dt id="HAS_MBRTOWC">HAS_MBRTOWC</dt>
<dd>

<p>d_mbrtowc</p>

</dd>
<dt id="HAS_MEMRCHR">HAS_MEMRCHR</dt>
<dd>

<p>d_memrchr</p>

</dd>
<dt id="HAS_NANOSLEEP">HAS_NANOSLEEP</dt>
<dd>

<p>d_nanosleep</p>

</dd>
<dt id="HAS_STRNLEN">HAS_STRNLEN</dt>
<dd>

<p>d_strnlen</p>

</dd>
<dt id="HAS_STRTOLD_L">HAS_STRTOLD_L</dt>
<dd>

<p>d_strtold_l</p>

</dd>
<dt id="I_WCHAR">I_WCHAR</dt>
<dd>

<p>i_wchar</p>

</dd>
</dl>

</dd>
<dt id="Removed-probes-and-keys">Removed probes and keys</dt>
<dd>

<dl>

<dt id="ansi2knr">ansi2knr</dt>
<dd>

</dd>
<dt id="d_bcmp">d_bcmp</dt>
<dd>

</dd>
<dt id="d_bcopy">d_bcopy</dt>
<dd>

</dd>
<dt id="d_bzero">d_bzero</dt>
<dd>

</dd>
<dt id="d_index">d_index</dt>
<dd>

</dd>
<dt id="d_charvspr">d_charvspr</dt>
<dd>

</dd>
<dt id="d_dbl_dig">d_dbl_dig</dt>
<dd>

</dd>
<dt id="d_safebcpy">d_safebcpy</dt>
<dd>

</dd>
<dt id="d_safemcpy">d_safemcpy</dt>
<dd>

</dd>
<dt id="d_sanemcmp">d_sanemcmp</dt>
<dd>

</dd>
<dt id="d_sprintf_returns_strlen">d_sprintf_returns_strlen</dt>
<dd>

</dd>
<dt id="d_strctcpy">d_strctcpy</dt>
<dd>

</dd>
<dt id="d_strerrm">d_strerrm</dt>
<dd>

</dd>
<dt id="i_memory">i_memory</dt>
<dd>

</dd>
<dt id="i_values">i_values</dt>
<dd>

</dd>
<dt id="i_varargs">i_varargs</dt>
<dd>

</dd>
<dt id="i_varhdr">i_varhdr</dt>
<dd>

</dd>
<dt id="strings">strings</dt>
<dd>

</dd>
<dt id="d_memset">d_memset</dt>
<dd>

<p>Beware: HAS_MEMSET is undefined since v5.28, but always considered to be defined. Because of C89. cperl kept the HAS_MEMSET preprocessor definition for backcompat with extensions which do use it. It is used in all ppport.h files to use memzero().</p>

</dd>
<dt id="d_memchr">d_memchr</dt>
<dd>

<p>Ditto: Keep HAS_MEMCHR</p>

</dd>
<dt id="d_memcmp">d_memcmp</dt>
<dd>

<p>Ditto: Keep HAS_MEMCMP</p>

</dd>
<dt id="d_memcpy">d_memcpy</dt>
<dd>

<p>Ditto: Keep HAS_MEMCPY</p>

</dd>
<dt id="d_memmove">d_memmove</dt>
<dd>

<p>Ditto: Keep HAS_MEMMOVE</p>

</dd>
<dt id="d_strchr">d_strchr</dt>
<dd>

<p>Ditto: Keep HAS_STRCHR</p>

</dd>
<dt id="d_strerror">d_strerror</dt>
<dd>

<p>Ditto: Keep HAS_STRERROR</p>

</dd>
<dt id="d_vprintf">d_vprintf</dt>
<dd>

<p>Ditto: Keep HAS_VPRINTF</p>

</dd>
<dt id="d_volatile">d_volatile</dt>
<dd>

<p>Ditto: Keep HASVOLATILE</p>

</dd>
<dt id="i_assert">i_assert</dt>
<dd>

<p>Ditto: Keep I_ASSERT in perl.h</p>

</dd>
<dt id="i_float">i_float</dt>
<dd>

<p>Ditto: Keep I_FLOAT in perl.h</p>

</dd>
<dt id="i_limits">i_limits</dt>
<dd>

<p>Ditto: Keep I_LIMITS in perl.h</p>

</dd>
<dt id="i_math">i_math</dt>
<dd>

<p>Ditto: Keep I_MATH in perl.h</p>

</dd>
<dt id="i_stdarg">i_stdarg</dt>
<dd>

<p>Ditto: Keep I_STDARG in perl.h</p>

</dd>
<dt id="i_stdlib">i_stdlib</dt>
<dd>

<p>Ditto: Keep I_STDLIB in perl.h</p>

</dd>
<dt id="i_string">i_string</dt>
<dd>

<p>Ditto: Keep I_STRING in perl.h</p>

</dd>
<dt id="prototype">prototype</dt>
<dd>

<p>Ditto: Keep CAN_PROTOTYPE in perl.h</p>

</dd>
<dt id="vaproto">vaproto</dt>
<dd>

<p>Ditto: Keep CAN_VAPROTO, _V</p>

</dd>
</dl>

</dd>
<dt id="git_version.sh">git_version.sh</dt>
<dd>

<p>New generated shell config with the same content as <i>git_version.h</i>, for <i>myconfig</i>.</p>

</dd>
<dt id="myconfig">myconfig</dt>
<dd>

<p>Added git_branch and git_describe.</p>

</dd>
<dt id="make_patchnum:-touch-the-targets">make_patchnum: touch the targets</dt>
<dd>

<p>avoiding needless miniperl recompilation on <i>Config_git.pl</i>, <i>git_version.{sh,h}</i>.</p>

</dd>
</dl>

<h1 id="Testing">Testing</h1>

<ul>

<li><p>Added <i>t/op/oelem.t</i> for classes with more than 256 fields, realloc fields for bigger padsize 2, and computed field names. cperl-only.</p>

</li>
<li><p>Changed one case in <i>t/op/symbolcache.t</i> for <a href="#Optimize-static-methods-to-subs">static method optimizations</a>. When you redefine a method, you need to clear the old method GV, to be able to call the new redefined one, as the static method optimization binds to the GV.</p>

</li>
<li><p>Many fixes for <code>make minitest</code>, for cperl/XSConfig.</p>

</li>
</ul>

<h1 id="Platform-Support">Platform Support</h1>

<h2 id="Discontinued-Platforms">Discontinued Platforms</h2>

<dl>

<dt id="PowerUX-Power-MAX-OS">PowerUX / Power MAX OS</dt>
<dd>

<p>Compiler hints and other support for these apparently long-defunct platforms has been removed.</p>

</dd>
</dl>

<h2 id="Platform-Specific-Notes">Platform-Specific Notes</h2>

<dl>

<dt id="Darwin">Darwin</dt>
<dd>

<p>Perl now correctly uses reentrant functions, like <code>asctime_r</code>, on versions of Darwin that have support for them.</p>

<p>locale specific error messages are now thread-safe. cperl-only, <a href="https://github.com/perl11/cperl/issues/341">[cperl #341]</a></p>

</dd>
<dt id="CentOS">CentOS</dt>
<dd>

<p>Compilation on CentOS 5 is now fixed.</p>

</dd>
<dt id="UMIPS">UMIPS</dt>
<dd>

<p>CAN_PROTOTYPE is now always defined, which might cause problems with the system cc compiler. <code>ccom: Error: ./mg.h, line 12: redeclaration of formal parameter, sv</code></p>

</dd>
<dt id="ULTRIX-4">ULTRIX 4</dt>
<dd>

<p>CAN_PROTOTYPE is now always defined, which might cause problems with the gcc-4.2 compiler.</p>

</dd>
<dt id="Windows">Windows</dt>
<dd>

<p>Visual C++ compiler version detection has been improved to work on non-English language systems.</p>

</dd>
</dl>

<h1 id="Internal-Changes">Internal Changes</h1>

<ul>

<li><p>Added <a href="/cperl/perlapi.html#hv_undef_flags">&quot;hv_undef_flags&quot; in perlapi</a> to the public API.</p>

</li>
<li><p>Refactored the <a>fields</a> API from global data into methods. Added a <a href="/cperl/perlapi.html#HvFIELDS">&quot;HvFIELDS&quot; in perlapi</a> field to HvAUX as linear buffer of &quot;name\0pad...\0&quot; fields, no class <code>%FIELDS</code> and <code>@FIELDS</code> anymore. See <a href="https://github.com/perl11/cperl/issues/322">[cperl #322]</a></p>

</li>
<li><p><a href="/cperl/perlintern.html#validate_proto">&quot;validate_proto&quot; in perlintern</a> got an additional cperl-only bool argument <code>maybe_sig</code>.</p>

</li>
<li><p>A new function, <a href="/cperl/perlapi.html#Perl_langinfo">Perl_langinfo()</a> has been added. It is an (almost) drop-in replacement for the system <code>nl_langinfo(3)</code>, but works on platforms that lack that; as well as being more thread-safe, and hiding some gotchas with locale handling from the caller. Code that uses this, needn&#39;t use <a href="http://man.he.net/man3/localeconv">localeconv(3)</a> (and be affected by the gotchas) to find the decimal point, thousands separator, or currency symbol. See <a href="/pod/perlapi.html#Perl_langinfo">&quot;Perl_langinfo&quot; in perlapi</a>.</p>

</li>
<li><p>A new API function <a href="/cperl/perlapi.html#sv_rvunweaken">sv_rvunweaken()</a> has been added to complement <a href="/pod/perlapi.html#sv_rvweaken">sv_rvweaken()</a>. The implementation was taken from <a>&quot;unweaken&quot; in Scalar::Util</a>.</p>

</li>
<li><p>A new flag, <code>SORTf_UNSTABLE</code>, has been added. This will allow a future commit to make mergesort unstable when the user specifies &lsquo;no sort stable&rsquo;, since it has been decided that mergesort should remain stable by default.</p>

</li>
<li><p>A new optimisation phase has been added to the compiler, <code>optimize_optree()</code>, which does a top-down scan of a complete optree just before the peephole optimiser is run. This phase is not currently hookable. This phase was previously in cperl named <code>prefinalize_op</code> and <code>postprocess_optree</code>.</p>

</li>
<li><p>An <code>OP_MULTICONCAT</code> op has been added. At <code>optimize_optree()</code> time, a chain of <code>OP_CONCAT</code> and <code>OP_CONST</code> ops, together optionally with an <code>OP_STRINGIFY</code> and/or <code>OP_SASSIGN</code>, are combined into a single <code>OP_MULTICONCAT</code> op. The op is of type <code>UNOP_AUX</code>, and the aux array contains the argument count, plus a pointer to a constant string and a set of segment lengths. For example with</p>

<pre><code>    my $x = &quot;foo=$foo, bar=$bar\n&quot;;</code></pre>

<p>the constant string would be <code>&quot;foo=, bar=\n&quot;</code> and the segment lengths would be (4,6,1). If the string contains characters such as <code>\x80</code>, whose representation changes under utf8, two sets of strings plus lengths are precomputed and stored.</p>

</li>
<li><p>Direct access to <a href="/cperl/perlapi.html#PL_keyword_plugin">PL_keyword_plugin</a> is not safe in the presence of multithreading. A new <a href="/pod/perlapi.html#wrap_keyword_plugin">wrap_keyword_plugin</a> function has been added to allow XS modules to safely define custom keywords even when loaded from a thread, analogous to <a href="/pod/perlapi.html#PL_check">PL_check</a> / <a href="/pod/perlapi.html#wrap_op_checker">wrap_op_checker</a>.</p>

</li>
</ul>

<h1 id="Selected-Bug-Fixes">Selected Bug Fixes</h1>

<ul>

<li><p>Fixed thread-safety with locale-specific error messages on darwin. <code>uselocal()</code> on darwin is not thread-safe, so we disable the local restauration to <code>uselocal(LC_GLOBAL_LOCALE)</code> in child threads. cperl-only, <a href="https://github.com/perl11/cperl/issues/341">[cperl #341]</a></p>

</li>
<li><p>Fetching the name of a glob that was previously UTF-8 but wasn&#39;t any longer would return that name flagged as UTF-8. <a href="https://rt.perl.org/Ticket/Display.html?id=131263">[perl #131263]</a></p>

</li>
<li><p>Fixed a duplicate symbol failure with <code>-flto -mieee-fp</code> builds. <i>pp.c</i> defined <code>_LIB_VERSION</code> which <code>-lieee</code> already defines. <a href="https://rt.perl.org/Ticket/Display.html?id=131786">[perl #131786]</a></p>

</li>
<li><p>The tokenizer no longer consumes the exponent part of a floating point number if it&#39;s incomplete. <a href="https://rt.perl.org/Ticket/Display.html?id=131725">[perl #131725]</a></p>

</li>
<li><p>On non-threaded builds, for <code>m/$null/</code> where <code>$null</code> is an empty string is no longer treated as if the <code>/o</code> flag was present when the previous matching match operator included the <code>/o</code> flag. The rewriting used to implement this behavior could confuse the interpreter. This matches the behaviour of threaded builds. <a href="https://rt.perl.org/Ticket/Display.html?id=124368">[perl #124368]</a></p>

</li>
<li><p>The tokenizer now correctly adjusts a parse pointer when skipping whitespace in a <code> ${identifier} </code> construct. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131949">[perl #131949]</a></p>

</li>
<li><p>Accesses to <code>${^LAST_FH}</code> no longer assert after using any of a variety of I/O operations on a non-glob. <a href="https://rt.perl.org/Public/Bug/Display.html?id=128263">[perl #128263]</a></p>

</li>
<li><p>The <code>Copy()</code>, <code>Move()</code>, <code>Zero()</code> macros and their variants now assert if the pointers supplied are <code>NULL</code>. ISO C considers supplying NULL pointers to the functions these macros are built upon as undefined behaviour even when their count parameters are zero. Based on these assertions and the original bug report three macro calls were made conditional. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131746">[perl #131746]</a> <a href="https://rt.perl.org/Public/Bug/Display.html?id=131892">[perl #131892]</a></p>

</li>
<li><p>The in-place sort optimisation now correctly strengthens weak references using the new <a href="/cperl/perlapi.html#sv_rvunweaken">sv_rvunweaken()</a> API function.</p>

</li>
<li><p>Package names are now always included in <code>:prototype</code> warnings <a href="https://rt.perl.org/Public/Bug/Display.html?id=131833">[perl #131833]</a></p>

</li>
<li><p>Creating a thread with no parameters no longer tries to <code>Copy()</code> a null pointer. This fixes an assertion failure and allows threaded builds to work again.</p>

</li>
<li><p>The <code>je_old_stack_hwm</code> field, previously only found in the <code>jmpenv</code> structure on debugging builds, has been added to non-debug builds as well. This fixes an issue with some CPAN modules caused by the size of this structure varying between debugging and non-debugging builds. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131942">[perl #131942]</a></p>

</li>
<li><p>The arguments to the <code>ninstr()</code> macro are now correctly parenthesized.</p>

</li>
<li><p>A NULL pointer dereference in the <code>S_regmatch()</code> function has been fixed. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132017">[perl #132017]</a></p>

</li>
<li><p>Calling <a href="/cperl/perlfunc.html#exec-PROGRAM-LIST">exec PROGRAM LIST</a> with an empty <code>LIST</code> has been fixed. This should call <code>execvp()</code> with an empty <code>argv</code> array (containing only the terminating <code>NULL</code> pointer), but was instead just returning false (and not setting <a href="/pod/perlvar.html#pod">$!</a>). <a href="https://rt.perl.org/Public/Bug/Display.html?id=131730">[perl #131730]</a></p>

</li>
<li><p>The <code>gv_fetchmeth_sv</code> C function stopped working properly in Perl 5.22 when fetching a constant with a UTF-8 name if that constant subroutine was stored in the stash as a simple scalar reference, rather than a full typeglob. This has been fixed.</p>

</li>
<li><p>Single-letter debugger commands followed by an argument which starts with punctuation (e.g. <code>p$^V</code> and <code>x@ARGV</code>) now work again. They had been wrongly requiring a space between the command and the argument. <a href="https://rt.perl.org/Public/Bug/Display.html?id=120174">[perl #120174]</a></p>

</li>
<li><p><a href="/cperl/perlfunc.html#splice-ARRAY-OFFSET-LENGTH-LIST">splice</a> now throws an exception (&quot;Modification of a read-only value attempted&quot;) when modifying a read-only array. Until now it had been silently modifying the array. The new behaviour is consistent with the behaviour of <a href="/pod/perlfunc.html#push-ARRAY-LIST">push</a> and <a href="/pod/perlfunc.html#unshift-ARRAY-LIST">unshift</a>. <a href="https://rt.perl.org/Public/Bug/Display.html?id=131000">[perl #131000]</a></p>

</li>
<li><p><code>stat()</code>, <code>lstat()</code>, and file test operators now fail if given a filename containing a nul character, in the same way that <code>open()</code> already fails.</p>

</li>
<li><p><code>stat()</code>, <code>lstat()</code>, and file test operators now reliably set <code>$!</code> when failing due to being applied to a closed or otherwise invalid file handle.</p>

</li>
<li><p>File test operators for Unix permission bits that don&#39;t exist on a particular platform, such as <code>-k</code> (sticky bit) on Windows, now check that the file being tested exists before returning the blanket false result, and yield the appropriate errors if the argument doesn&#39;t refer to a file.</p>

</li>
<li><p>The in-place reverse optimisation now correctly strengthens weak references using the <a href="/cperl/perlapi.html#sv_rvunweaken">sv_rvunweaken()</a> API function.</p>

</li>
<li><p>Fixed a read before buffer when parsing a range starting with <code>\N{}</code> at the beginning of the character set for the transliteration operator. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132245">[perl #132245]</a></p>

</li>
<li><p>Fixed a leaked SV when parsing an empty <code>\N{}</code> at compile-time. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132245">[perl #132245]</a></p>

</li>
<li><p>Calling <code>do $path</code> on a directory or block device now yields a meaningful error code in <code>$!</code>. <a href="https://rt.perl.org/Public/Bug/Display.html?id=125774">[perl #125774]</a></p>

</li>
<li><p>Regexp substitution using an overloaded replacement value that provides a tainted stringification now correctly taints the resulting string. <a href="https://rt.perl.org/Public/Bug/Display.html?id=115266">[perl #115266]</a></p>

</li>
<li><p>Lexical sub declarations in <code>do</code> blocks such as <code>do { my sub lex; 123 }</code> could corrupt the stack, erasing items already on the stack in the enclosing statement. This has been fixed. <a href="https://rt.perl.org/Public/Bug/Display.html?id=132442">[perl #132442]</a></p>

</li>
</ul>

<h1 id="Known-Problems">Known Problems</h1>

<ul>

<li><p>Classes are still experimental, and have some limitations:</p>

<p>Cannot be created in an eval block or subroutine. The pad lookup is still global and not per optional CvPADLIST.</p>

<p>Method composition with overlapping field indices does not work yet. This requires the not yet finished inliner. <code>panic: cannot yet adjust field indices when composing role %s::%s into %s %s [cperl #311]</code></p>

<p>Array and hash fields cannot be parsed yet.</p>

</li>
</ul>

<h1 id="Acknowledgements">Acknowledgements</h1>

<p>cperl 5.27.2 represents approximately 4 months of development since cperl 5.27.1c and contains approximately 250,000 lines of changes across 1,800 files from 50 authors.</p>

<p>Excluding auto-generated files, documentation and release tools, there were approximately 82,000 lines of changes to 630 .pm, .t, .c and .h files.</p>

<p>The following people are known to have contributed the improvements that became cperl 5.27.2:</p>

<p>Karl Williamson, David Mitchell, Reini Urban, Aaron Crane, Tony Cook, Father Chrysostomos, Zefram, Lukas Mai, Dagfinn Ilmari Manns&aring;ker, Steve Hay, Nicolas Rochelemagne, Yves Orton, James E Keenan, Craig A. Berry, H.Merijn Brand, Chris &#39;BinGOs&#39; Williams, Abigail, Todd Rinaldo, Dominic Hargreaves, Sawyer X, Matthew Horsfall, Aristotle Pagaltzis, Steffen M&uuml;ller, Jarkko Hietaniemi, Daniel Dragan, Eric Herman, Smylers, Vitali Peil, David H. Gutteridge, Neil Bowers, John P. Linderman, Thomas Sibley, Graham Knop, E. Choroba, Andrew Fresh, Dmitry Ulanov, John Lightsey, Ricardo Signes, Tom Hukins, Ken Cotterill, Andy Lester, Jacques Germishuys, Eugen Konkov, Andy Dougherty, John Peacock, Nicholas Clark, Slaven Rezic, Harald J&ouml;rg, Dan Collins, John SJ Anderson.</p>

<p>The list above is almost certainly incomplete as it is automatically generated from version control history including the perl and cperl repos. In particular, it does not include the names of the (very much appreciated) contributors who reported issues to the Perl bug tracker and the cperl github issues.</p>

<p>Many of the changes included in this version originated in the CPAN modules included in Perl&#39;s core. We&#39;re grateful to the entire CPAN community for helping Perl to flourish.</p>

<p>For a more complete list of all of Perl&#39;s historical contributors, please see the <i>AUTHORS</i> file in the Perl source distribution.</p>

<p>Generated with:</p>

<pre><code>    cperl Porting/acknowledgements.pl cperl-5.27.1..HEAD -c</code></pre>

<h1 id="Reporting-Bugs">Reporting Bugs</h1>

<p>If you find what you think is a bug, you might check the articles recently posted to the comp.lang.perl.misc newsgroup and the perl bug database at <a href="https://rt.perl.org/">https://rt.perl.org/</a> . There may also be information at <a href="http://www.perl.org/">http://www.perl.org/</a> , the Perl Home Page.</p>

<p>If you believe you have an unreported bug, please run the <a>cperlbug</a> program included with your release. Be sure to trim your bug down to a tiny but sufficient test case. Your bug report, along with the output of <code>perl -V</code>, will be sent off to perlbug@perl.org to be analysed by the Perl porting team.</p>

<p>If you think it&#39;s a cperl specific bug or trust the cperl developers more please file an issue at <a href="https://github.com/perl11/cperl/issues">https://github.com/perl11/cperl/issues</a>.</p>

<p>If the bug you are reporting has security implications which make it inappropriate to send to a publicly archived mailing list, then see <a href="/cperl/perlsec.html#SECURITY-VULNERABILITY-CONTACT-INFORMATION">&quot;SECURITY VULNERABILITY CONTACT INFORMATION&quot; in perlsec</a> For details of how to report the issue.</p>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p>The <i>Changes</i> file for an explanation of how to view exhaustive details on what changed.</p>

<p>The <i>INSTALL</i> file for how to build Perl.</p>

<p>The <i>README</i> file for general stuff.</p>

<p>The <i>Artistic</i> and <i>Copying</i> files for copyright information.</p>


</body>

</html>



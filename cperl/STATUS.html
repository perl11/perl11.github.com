<h1>cperl status</h1>

<p>The name <strong>cperl</strong> stands for <strong>a perl with classes, types, compiler
support, or just a company-friendly perl</strong>, but currently it's only a
better 5.22 based variant without classes.</p>

<p>cperl started Feb. 2015 when :const was added, parrot was killed and
it became clear that optimizing for fun is better than waiting for
someone else to allow it.</p>

<p>Currently it is about 1.5x faster than perl5.22 overall, >2x faster
then 5.14 and uses the least amount of memory measured since 5.6,
i.e. less than 5.10 and 5.6.2, which were the previous leaders. While
perl5.22 uses the most memory yet measured.</p>

<p>But not all of the wanted features are merged.  The plan is to support
most perl5-compatible perl6 features (<em>"do not break CPAN"</em>), improve
performance and memory usage, re-establish compiler (<code>B::C</code>) support,
re-establish perl5 core development which essentially stopped 2002,
and better security fixes and maintenance than the upstream p5p
perl5. See <a href="perlcperl.html">README.cperl</a>.</p>

<p>Tested and developed on linux and darwin 64bit. <strong>32bit does not work yet!</strong></p>

<p>The first release based on 5.22.1 is scheduled on Sep 14. 2015.</p>

<p>All tests pass, most of CPAN works, 3 fixes in the distroprefs repo
for <code>Variable::Magic</code> and <code>CPAN::Meta::Requirements</code> and <code>version</code> are needed.
This is much less than with a typical major perl5 release.</p>

<p><img src="cperl-m0.png" alt="Memory usage: perl -e0" /></p>

<p><img src="cperl-p0.png" alt="Memory usage: with Config_heavy" /></p>

<p><img src="cperl-p1.png" alt="Memory usage with unicode s///i" /></p>

<p>Issues will be copied over from our internal stash repo to the public
github repo soon.</p>

<h1>In the stable master branch are the following major features</h1>

<ul>
<li>coretypes (Int, UInt, Num, Str. lowercase native types accepted)</li>
<li>types in signatures as designed and also as attribute</li>
<li>function return types declarations as attribute</li>
<li>many more builtin function attributes</li>
<li>shaped arrays with compile-time checks and optims</li>
<li>static loop optims</li>
<li>fast arithmetic overflow</li>
<li>convert static method to subs</li>
<li>Config as XS</li>
<li>strict, attributes, DynaLoader, XSLoader as builtin packages, rewritten in C</li>
<li>changed default hash function to the fastest FNV1A <em>(as in the stableperl fork)</em></li>
<li>seperate XS and PP XS calls dynamically with a new enterxssub op</li>
<li>-DI and -Dk</li>
<li>add some unicode ops</li>
<li>improved build system (make -s, faster, CC vs LD confusion)</li>
<li>hash keys keep the tainted info (see perlsec)</li>
<li>fix ops using lexical $_</li>
</ul>

<p>Most of them only would have a chance to be merged upstream if a
p5p committer would have written it.</p>

<p>But some features some revert some decisions p5p made already. See perlcperl.
When in doubt I went with the decisions and policies perl5 made
before 2001. It is very unlikely that p5p will revert their own design
mistakes. It never happened so far.</p>

<h1>Known bugs</h1>

<p>See the github issues: <a href="http://github.com/perl11/cperl/issues">github.com/perl11/cperl/issues</a></p>

<p>With 32bit <code>t/opbasic/arith.t</code> is broken. This is the only known blocker.</p>

<h1>Branch overview</h1>

<h2>Bugfixes for perl5 upstream</h2>

<ul>
<li><a href="http://github.com/perl11/cperl/commits/merge-upstream">merge-upstream</a></li>
</ul>

<p>This can be easily taken up upstream, was already perlbug'ed and published,
and do not violate any of the p5p commit policies and previous decisions.
From those 47 patches 2 were taken so far and 2 were butchered, i.e. rewritten
in a worse way.</p>

<h2>Almost ready branches, only minor tests are failing</h2>

<p>Those branches could theoretically be merged upstream, but the chances
are limited. So they are based on master.</p>

<ul>
<li><p><a href="http://github.com/perl11/cperl/commits/bugfix/CM-600-cperl-cowrefcnt">bugfix/CM-600-cperl-cowrefcnt</a></p>

<p>works, but does not do COW yet, i.e. slower for uncompiled perls, faster for compiled</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-367-cperl-warnings-xs-carp">feature/CM-367-cperl-warnings-xs-carp</a></p></li>
<li><a href="http://github.com/perl11/cperl/commits/feature/CM-367-cperl-carp-builtin">feature/CM-367-cperl-carp-builtin</a></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-370-cperl-warnings-xs">feature/CM-370-cperl-warnings-xs</a></p>

<p>much faster and much less memory, but 3 minor scope test fails.</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-317-cperl-signatures3">feature/CM-317-cperl-signatures3</a></p>

<p>2x faster</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-317-cperl-signatures3-CM-690-nl">feature/CM-317-cperl-signatures3-CM-690-nl</a></p>

<p>newlines in sigs broken</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-916-cperl-no-miniperl">feature/CM-916-cperl-no-miniperl</a></p>

<p>fix the Makefile deps</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-626-cperl-use-dots">feature/CM-626-cperl-use-dots</a></p>

<p>works, but unsure if good enough</p></li>
</ul>

<h2>A bit more work is needed for</h2>

<p>These are major new features, and have no chance to be merged upstream.
They also revert some wrong decisions p5p already made.</p>

<ul>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-713-cperl-native-types">feature/CM-713-cperl-native-types</a>
int, uint, num, str. some compiler fixes needed</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-707-cperl-inline-subs">feature/CM-707-cperl-inline-subs</a>
some compiler fixes needed</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-712-cperl-types-proto">feature/CM-712-cperl-types-proto</a>
constant fold everything, not only with empty () protos</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-322-cperl-new-hash-table">feature/CM-322-cperl-new-hash-table</a>
lots of attempts, but still too hairy. needs a complete hash rewrite probably.</p></li>
<li><p><a href="http://github.com/perl11/cperl/commits/feature/CM-910-cperl-multi">feature/CM-910-cperl-multi</a>
class, method and multi keywords</p></li>
</ul>

<h2>Soon</h2>

<ul>
<li><p>conversion from private stash to public github repo and issues</p></li>
<li><p>user facing types and classes, multiple dispatch</p></li>
<li>builtin macros</li>
<li>builtin ffi</li>
</ul>

<p>2015-09-04 rurban</p>

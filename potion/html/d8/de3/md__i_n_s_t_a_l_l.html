<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>potion: ~ building potion ~</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">potion
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/de3/md__i_n_s_t_a_l_l.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">~ building potion ~ </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Normally </p><pre class="fragment">$ make
</pre><p>To build with debugging symbols </p><pre class="fragment">$ make DEBUG=1
</pre><p>To build without JIT </p><pre class="fragment">$ make JIT=0
</pre><p>Lastly, to verify your build </p><pre class="fragment">$ make test
</pre><p>On a typical GNU make &lt; 4.0 sometimes the <code>test/classes/creatures/</code> fails. Try <code>make -j1 test</code> or gmake-4.0 then.</p>
<h2>~ the latest potion ~</h2>
<p>To build the bleeding edge, you will need GNU make, binutils and clang or gcc. clang produces better code than gcc, but is harder to debug. </p><pre class="fragment">$ git clone git://github.com/perl11/potion.git
$ cd potion
$ git submodule update --init
$ make
</pre><h2>~ external dependencies ~</h2>
<pre class="fragment">build-time: gnu make, perl, sed, gcc or clang, echo, cat, expr, git
perl is only needed because of BSD/darwin sed problems)

run-time:
libuv is included, but external packagers
should choose to use existing packages. see dist.mak

optional:

libudis on x86 (debugging only)
  http://udis86.sourceforge.net/ x86 16,32,64 bit
  port install udis86

libdistorm64 on x86 (debugging only)
  http://ragestorm.net/distorm/ x86 16,32,64 bit with all intel/amd extensions
  apt-get install libdistorm64-dev

libdisasm on i386 (debugging only)
  http://bastard.sourceforge.net/libdisasm.html 386 32bit only
  apt-get install libdisasm-dev

sloccount (for make sloc)
  apt-get install sloccount

redcloth (for make doc install)
  apt-get install ruby-redcloth, or
  port install rb-redcloth

doxygen 1.8 or 1.9 (for make doc install)
  apt-get install doxygen, or
  port install doxygen

GNU global (for make docall install)
  apt-get install global, or
  port install global
</pre><h2>~ sandboxing ~</h2>
<p>With <code>gmake SANDBOX=1</code> a static sandboxed <code>bin/potion-s</code> is built, which excludes all local filesystem and process accesses and includes all external modules in one executable. <code>load</code> is also disabled, so modules must include all dependent libraries.</p>
<p>Network access is enabled via Aio. If you want to disable networking also, remove <code>lib/aio.c</code> from the SANDBOX SRC in <code>Makefile</code>, and <code>Potion_Init_aio(P)</code> from <code><a class="el" href="../../dc/df8/internal_8c.html" title="memory allocation and innards ">core/internal.c</a></code></p>
<h2>~ installing ~</h2>
<pre class="fragment">$ sudo make install
</pre><h2>~ building on windows ~</h2>
<p>Potion's win32 binaries are built using MinGW. <a href="http://mingw.org/">http://mingw.org/</a></p>
<p>It's a bit hard to setup mingw and gmake on Windows. I usually run a shell under Cygwin and add MinGW to my $PATH.</p>
<p>Once that's all done, </p><pre class="fragment">$ make
</pre><p>The easiest way to do this, actually, is on Linux or Darwin. On Ubuntu, if you have MinGW installed, </p><pre class="fragment">$ make clean; make core/syntax.c
$ make config CC=i686-w64-mingw32-gcc CROSS=1
$ touch core/syntax.c
$ make &amp;&amp; make dist
</pre><p>This will first create a native greg and core/syntax.c, sets CROSS=1 and cross-compiles with the given CC. See tools/mk-release.sh. make test will not work, you need to copy a make dist tarball to the machine and test it there.</p>
<p>win64 is not supported yet. It uses a slighlty different ABI, cygwin64 misses pthread_barrier_t. and x86_64-w64-mingw32-gcc fails by creating a wrong <code><a class="el" href="../../db/d16/config_8h.html">config.h</a></code></p>
<h2>~ building on bsd ~</h2>
<p>BSD make is not supported. You can either install gnu make (gmake) </p><pre class="fragment">$ sudo port install gmake
</pre><p>or try <code>./configure</code> which creates a special BSD <code>config.mk</code></p>
<p>or try to merge 'master' with the branch 'bsd' </p><pre class="fragment">$ git merge bsd
... resolve conflicts, or not
</pre><h2>~ building with a strict C++ compiler ~</h2>
<p>potion does not support strict C++ compilers.</p>
<p>Either add a C dialect to CC in config.inc (i.e. -std=c89), </p><pre class="fragment">g++ --help=C; clang++ -x C -std=gnu89
</pre><p>or try to merge with the branch 'p2-c++'.</p>
<h2>~ creating documentation ~</h2>
<p>This is required for <code>make dist</code> and release admins. You'll need: </p><pre class="fragment">redcloth to convert .textile to html,
doxygen (1.8 or 1.9), and
GNU global for gtags and htags
</pre><p>On windows et al.: <code>gem install RedCloth</code> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 11 2014 for potion .1153 (date="2014-09-11")
) by <a href="http://www.doxygen.org/index.html">doxygen</a>  1.8.7
</small></address></body></html>

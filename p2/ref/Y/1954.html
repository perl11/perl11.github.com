<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>vt</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.2.8' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/138.html#L280'>vt</a>                280 core/gc.c        if (ptr-&gt;vt &gt; PN_TUSER) {</span>
<span class='curline'><a href='../S/138.html#L281'>vt</a>                281 core/gc.c          if (P-&gt;vts &amp;&amp; PN_VTABLE(ptr-&gt;vt) &amp;&amp; PN_TYPECHECK(ptr-&gt;vt))</span>
<span class='curline'><a href='../S/138.html#L283'>vt</a>                283 core/gc.c      	(((struct PNVtable *)PN_VTABLE(ptr-&gt;vt))-&gt;ivlen * sizeof(PN));</span>
<span class='curline'><a href='../S/138.html#L290'>vt</a>                290 core/gc.c      	      (unsigned long)ptr, (unsigned long)ptr-&gt;vt);</span>
<span class='curline'><a href='../S/138.html#L294'>vt</a>                294 core/gc.c        switch (ptr-&gt;vt) {</span>
<span class='curline'><a href='../S/138.html#L374'>vt</a>                374 core/gc.c        if (ptr-&gt;vt &gt; PN_TUSER) {</span>
<span class='curline'><a href='../S/138.html#L375'>vt</a>                375 core/gc.c          GC_MINOR_UPDATE(PN_VTABLE(ptr-&gt;vt));</span>
<span class='curline'><a href='../S/138.html#L376'>vt</a>                376 core/gc.c          int ivars = ((struct PNVtable *)PN_VTABLE(ptr-&gt;vt))-&gt;ivlen;</span>
<span class='curline'><a href='../S/138.html#L382'>vt</a>                382 core/gc.c        switch (ptr-&gt;vt) {</span>
<span class='curline'><a href='../S/138.html#L469'>vt</a>                469 core/gc.c        if (ptr-&gt;vt &gt; PN_TUSER) {</span>
<span class='curline'><a href='../S/138.html#L470'>vt</a>                470 core/gc.c          GC_MAJOR_UPDATE(PN_VTABLE(ptr-&gt;vt));</span>
<span class='curline'><a href='../S/138.html#L471'>vt</a>                471 core/gc.c          int ivars = ((struct PNVtable *)PN_VTABLE(ptr-&gt;vt))-&gt;ivlen;</span>
<span class='curline'><a href='../S/138.html#L477'>vt</a>                477 core/gc.c        switch (ptr-&gt;vt) {</span>
<span class='curline'><a href='../S/139.html#L112'>vt</a>                112 core/internal.c   P-&gt;vt = PN_TSTATE;</span>
<span class='curline'><a href='../S/145.html#L69'>vt</a>                 69 core/objmodel.c void potion_add_metaclass(Potion *P, vPN(Vtable) vt) {</span>
<span class='curline'><a href='../S/145.html#L70'>vt</a>                 70 core/objmodel.c   struct PNVtable *meta = vt-&gt;meta = PN_CALLOC_N(PN_TVTABLE, struct PNVtable, 0);</span>
<span class='curline'><a href='../S/145.html#L84'>vt</a>                 84 core/objmodel.c   vPN(Vtable) vt = PN_CALLOC_N(PN_TVTABLE, struct PNVtable, 0);</span>
<span class='curline'><a href='../S/145.html#L85'>vt</a>                 85 core/objmodel.c   vt-&gt;type = t;</span>
<span class='curline'><a href='../S/145.html#L86'>vt</a>                 86 core/objmodel.c   vt-&gt;name = PN_NIL;</span>
<span class='curline'><a href='../S/145.html#L87'>vt</a>                 87 core/objmodel.c   vt-&gt;parent = self ? ((struct PNVtable *)self)-&gt;type : 0;</span>
<span class='curline'><a href='../S/145.html#L88'>vt</a>                 88 core/objmodel.c   vt-&gt;methods = (struct PNTable *)potion_table_empty(P);</span>
<span class='curline'><a href='../S/145.html#L89'>vt</a>                 89 core/objmodel.c   vt-&gt;ctor = PN_FUNC(potion_no_call, 0);</span>
<span class='curline'><a href='../S/145.html#L90'>vt</a>                 90 core/objmodel.c   PN_VTABLE(t) = (PN)vt;</span>
<span class='curline'><a href='../S/145.html#L91'>vt</a>                 91 core/objmodel.c   potion_add_metaclass(P, vt);</span>
<span class='curline'><a href='../S/145.html#L92'>vt</a>                 92 core/objmodel.c   return (PN)vt;</span>
<span class='curline'><a href='../S/145.html#L96'>vt</a>                 96 core/objmodel.c   vPN(Vtable) vt = (vPN(Vtable))potion_type_new(P, t, self);</span>
<span class='curline'><a href='../S/145.html#L97'>vt</a>                 97 core/objmodel.c   vt-&gt;name = name;</span>
<span class='curline'><a href='../S/145.html#L98'>vt</a>                 98 core/objmodel.c   return (PN)vt;</span>
<span class='curline'><a href='../S/145.html#L101'>vt</a>                101 core/objmodel.c void potion_type_call_is(PN vt, PN cl) {</span>
<span class='curline'><a href='../S/145.html#L102'>vt</a>                102 core/objmodel.c   ((struct PNVtable *)vt)-&gt;call = cl;</span>
<span class='curline'><a href='../S/145.html#L111'>vt</a>                111 core/objmodel.c void potion_type_callset_is(PN vt, PN cl) {</span>
<span class='curline'><a href='../S/145.html#L112'>vt</a>                112 core/objmodel.c   ((struct PNVtable *)vt)-&gt;callset = cl;</span>
<span class='curline'><a href='../S/145.html#L121'>vt</a>                121 core/objmodel.c void potion_type_constructor_is(PN vt, PN cl) {</span>
<span class='curline'><a href='../S/145.html#L122'>vt</a>                122 core/objmodel.c   ((struct PNVtable *)vt)-&gt;ctor = cl;</span>
<span class='curline'><a href='../S/145.html#L155'>vt</a>                155 core/objmodel.c     struct PNVtable *vt = (struct PNVtable *)PN_FLEX_AT(P-&gt;vts, i);</span>
<span class='curline'><a href='../S/145.html#L156'>vt</a>                156 core/objmodel.c     if (vt &amp;&amp; vt-&gt;name == name)</span>
<span class='curline'><a href='../S/145.html#L157'>vt</a>                157 core/objmodel.c       return (PN)vt;</span>
<span class='curline'><a href='../S/145.html#L163'>vt</a>                163 core/objmodel.c   struct PNVtable *vt = (struct PNVtable *)self;</span>
<span class='curline'><a href='../S/145.html#L169'>vt</a>                169 core/objmodel.c   vt-&gt;ivfunc = PN_ALLOC_FUNC(asmb-&gt;len);</span>
<span class='curline'><a href='../S/145.html#L170'>vt</a>                170 core/objmodel.c   PN_MEMCPY_N(vt-&gt;ivfunc, asmb-&gt;ptr, u8, asmb-&gt;len);</span>
<span class='curline'><a href='../S/145.html#L172'>vt</a>                172 core/objmodel.c   vt-&gt;ivlen = PN_TUPLE_LEN(ivars);</span>
<span class='curline'><a href='../S/145.html#L173'>vt</a>                173 core/objmodel.c   vt-&gt;ivars = ivars;</span>
<span class='curline'><a href='../S/145.html#L179'>vt</a>                179 core/objmodel.c   vPN(Vtable) vt = (struct PNVtable *)PN_VTABLE(t);</span>
<span class='curline'><a href='../S/145.html#L180'>vt</a>                180 core/objmodel.c   if (vt-&gt;ivfunc != NULL)</span>
<span class='curline'><a href='../S/145.html#L181'>vt</a>                181 core/objmodel.c     return vt-&gt;ivfunc(PN_UNIQ(ivar));</span>
<span class='curline'><a href='../S/145.html#L218'>vt</a>                218 core/objmodel.c   vPN(Vtable) vt = (struct PNVtable *)self;</span>
<span class='curline'><a href='../S/145.html#L219'>vt</a>                219 core/objmodel.c   unsigned k = kh_put(PN, vt-&gt;methods, key, &amp;ret);</span>
<span class='curline'><a href='../S/145.html#L220'>vt</a>                220 core/objmodel.c   PN_QUICK_FWD(struct PNTable *, vt-&gt;methods);</span>
<span class='curline'><a href='../S/145.html#L221'>vt</a>                221 core/objmodel.c   PN_TOUCH(vt-&gt;methods);</span>
<span class='curline'><a href='../S/145.html#L232'>vt</a>                232 core/objmodel.c   kh_val(PN, vt-&gt;methods, k) = method;</span>
<span class='curline'><a href='../S/145.html#L240'>vt</a>                240 core/objmodel.c     P-&gt;target.mcache(P, vt, &amp;asmb);</span>
<span class='curline'><a href='../S/145.html#L242'>vt</a>                242 core/objmodel.c       if (vt-&gt;mcache == NULL)</span>
<span class='curline'><a href='../S/145.html#L243'>vt</a>                243 core/objmodel.c         vt-&gt;mcache = PN_ALLOC_FUNC(4096);</span>
<span class='curline'><a href='../S/145.html#L244'>vt</a>                244 core/objmodel.c       PN_MEMCPY_N(vt-&gt;mcache, asmb-&gt;ptr, u8, asmb-&gt;len);</span>
<span class='curline'><a href='../S/145.html#L245'>vt</a>                245 core/objmodel.c     } else if (vt-&gt;mcache != NULL) {</span>
<span class='curline'><a href='../S/145.html#L246'>vt</a>                246 core/objmodel.c       potion_munmap(vt-&gt;mcache, 4096);</span>
<span class='curline'><a href='../S/145.html#L247'>vt</a>                247 core/objmodel.c       vt-&gt;mcache = NULL;</span>
<span class='curline'><a href='../S/145.html#L255'>vt</a>                255 core/objmodel.c   vPN(Vtable) vt = (struct PNVtable *)self;</span>
<span class='curline'><a href='../S/145.html#L257'>vt</a>                257 core/objmodel.c   if (vt-&gt;mcache != NULL)</span>
<span class='curline'><a href='../S/145.html#L258'>vt</a>                258 core/objmodel.c     return vt-&gt;mcache(PN_UNIQ(key));</span>
<span class='curline'><a href='../S/145.html#L260'>vt</a>                260 core/objmodel.c   unsigned k = kh_get(PN, vt-&gt;methods, key);</span>
<span class='curline'><a href='../S/145.html#L261'>vt</a>                261 core/objmodel.c   if (k != kh_end(vt-&gt;methods)) return kh_val(PN, vt-&gt;methods, k);</span>
<span class='curline'><a href='../S/145.html#L267'>vt</a>                267 core/objmodel.c   PN vt = PN_NIL;</span>
<span class='curline'><a href='../S/145.html#L271'>vt</a>                271 core/objmodel.c     vt = (PN)((struct PNVtable *)rcv)-&gt;meta;</span>
<span class='curline'><a href='../S/145.html#L273'>vt</a>                273 core/objmodel.c     vt = PN_VTABLE(t);</span>
<span class='curline'><a href='../S/145.html#L277'>vt</a>                277 core/objmodel.c       ? potion_lookup(P, 0, vt, msg)</span>
<span class='curline'><a href='../S/145.html#L278'>vt</a>                278 core/objmodel.c       : potion_send(vt, PN_lookup, msg);</span>
<span class='curline'><a href='../S/145.html#L279'>vt</a>                279 core/objmodel.c     if (closure || !((struct PNVtable *)vt)-&gt;parent) break;</span>
<span class='curline'><a href='../S/145.html#L280'>vt</a>                280 core/objmodel.c     vt = PN_VTABLE(((struct PNVtable *)vt)-&gt;parent);</span>
<span class='curline'><a href='../S/145.html#L336'>vt</a>                336 core/objmodel.c   struct PNVtable *vt = (struct PNVtable *)PN_VTABLE(self-&gt;vt);</span>
<span class='curline'><a href='../S/145.html#L337'>vt</a>                337 core/objmodel.c   if (vt-&gt;name != PN_NIL) {</span>
<span class='curline'><a href='../S/145.html#L339'>vt</a>                339 core/objmodel.c     pn_printf(P, str, "&lt;%s %x&gt;", PN_STR_PTR(vt-&gt;name), (PN)self);</span>
<span class='curline'><a href='../S/145.html#L356'>vt</a>                356 core/objmodel.c   vPN(Vtable) vt = (struct PNVtable *)self;</span>
<span class='curline'><a href='../S/145.html#L357'>vt</a>                357 core/objmodel.c   if (PN_IS_METACLASS(vt)) // TODO: error</span>
<span class='curline'><a href='../S/145.html#L359'>vt</a>                359 core/objmodel.c   if (vt-&gt;type == PN_TVTABLE) // TODO: error</span>
<span class='curline'><a href='../S/145.html#L361'>vt</a>                361 core/objmodel.c   return (PN)PN_ALLOC_N(vt-&gt;type, struct PNObject,</span>
<span class='curline'><a href='../S/145.html#L362'>vt</a>                362 core/objmodel.c     potion_type_size(P, (struct PNObject *)self) - sizeof(struct PNObject) + vt-&gt;ivlen * sizeof(PN));</span>
<span class='curline'><a href='../S/145.html#L385'>vt</a>                385 core/objmodel.c static void potion_init_class_reference(Potion *P, PN name, PN vt) {</span>
<span class='curline'><a href='../S/145.html#L386'>vt</a>                386 core/objmodel.c   potion_send(P-&gt;lobby, PN_def, name, vt);</span>
<span class='curline'><a href='../S/145.html#L387'>vt</a>                387 core/objmodel.c   ((struct PNVtable *)vt)-&gt;name = name;</span>
<span class='curline'><a href='../S/145.html#L390'>vt</a>                390 core/objmodel.c   ((struct PNVtable *)vt)-&gt;meta-&gt;name = potion_str(P, meta_str);</span>
<span class='curline'><a href='../S/147.html#L107'>vt</a>                107 core/potion.h  #define PN_VTYPE(x)     (((struct PNObject *)(x))-&gt;vt)</span>
<span class='curline'><a href='../S/147.html#L202'>vt</a>                202 core/potion.h    PNType vt; \</span>
<span class='curline'><a href='../S/147.html#L389'>vt</a>                389 core/potion.h        return ((struct PNObject *)o)-&gt;vt;</span>
<span class='curline'><a href='../S/147.html#L393'>vt</a>                393 core/potion.h    return ((struct PNObject *)potion_fwd(obj))-&gt;vt;</span>
<span class='curline'><a href='../S/147.html#L410'>vt</a>                410 core/potion.h    if (((struct PNString *)s)-&gt;vt == PN_TSTRING)</span>
<span class='curline'><a href='../S/147.html#L513'>vt</a>                513 core/potion.h  static inline void *potion_gc_alloc(Potion *P, PNType vt, int siz) {</span>
<span class='curline'><a href='../S/147.html#L522'>vt</a>                522 core/potion.h    res-&gt;vt = vt;</span>
<span class='curline'><a href='../S/147.html#L529'>vt</a>                529 core/potion.h  static inline void *potion_gc_calloc(Potion *P, PNType vt, int siz) {</span>
<span class='curline'><a href='../S/147.html#L530'>vt</a>                530 core/potion.h    return potion_gc_alloc(P, vt, siz);</span>
<span class='curline'><a href='../S/147.html#L545'>vt</a>                545 core/potion.h  static inline void *potion_gc_realloc(Potion *P, PNType vt, struct PNObject * volatile obj, PN_SIZE sz) {</span>
<span class='curline'><a href='../S/147.html#L555'>vt</a>                555 core/potion.h    dst = potion_gc_alloc(P, vt, sz);</span>
<span class='curline'><a href='../S/130.html#L345'>vt</a>                345 core/vm-ppc.c  void potion_ppc_mcache(Potion *P, vPN(Vtable) vt, PNAsm * volatile *asmp) {</span>
<span class='curline'><a href='../S/131.html#L753'>vt</a>                753 core/vm-x86.c  void potion_x86_mcache(Potion *P, vPN(Vtable) vt, PNAsm * volatile *asmp) {</span>
<span class='curline'><a href='../S/131.html#L760'>vt</a>                760 core/vm-x86.c    for (k = kh_end(vt-&gt;methods); k &gt; kh_begin(vt-&gt;methods); k--) {</span>
<span class='curline'><a href='../S/131.html#L761'>vt</a>                761 core/vm-x86.c      if (kh_exist(PN, vt-&gt;methods, k - 1)) {</span>
<span class='curline'><a href='../S/131.html#L763'>vt</a>                763 core/vm-x86.c          ASMI(PN_UNIQ(kh_key(PN, vt-&gt;methods, k - 1))); // cmp NAME %edi</span>
<span class='curline'><a href='../S/131.html#L765'>vt</a>                765 core/vm-x86.c        X86_PRE(); ASM(0xB8); ASMN(kh_val(PN, vt-&gt;methods, k - 1)); // mov CL %rax</span>
<span class='curline'><a href='../S/160.html#L218'>vt</a>                218 front/p2.c     		scanptr, ((struct PNObject *)scanptr)-&gt;vt,</span>
<span class='curline'><a href='../S/160.html#L222'>vt</a>                222 front/p2.c     	  if ((signed long)(((struct PNObject *)scanptr)-&gt;vt) &lt; 0</span>
<span class='curline'><a href='../S/160.html#L223'>vt</a>                223 front/p2.c     	      || ((struct PNObject *)scanptr)-&gt;vt &gt; PN_TUSER) {</span>
<span class='curline'><a href='../S/160.html#L225'>vt</a>                225 front/p2.c     		    scanptr, ((struct PNObject *)scanptr)-&gt;vt);</span>
<span class='curline'><a href='../S/161.html#L188'>vt</a>                188 front/potion.c 		scanptr, ((struct PNObject *)scanptr)-&gt;vt,</span>
<span class='curline'><a href='../S/161.html#L192'>vt</a>                192 front/potion.c 	  if ((signed long)(((struct PNObject *)scanptr)-&gt;vt) &lt; 0</span>
<span class='curline'><a href='../S/161.html#L193'>vt</a>                193 front/potion.c 	      || ((struct PNObject *)scanptr)-&gt;vt &gt; PN_TUSER) {</span>
<span class='curline'><a href='../S/161.html#L195'>vt</a>                195 front/potion.c 		    scanptr, ((struct PNObject *)scanptr)-&gt;vt);</span>
<span class='curline'><a href='../S/57.html#L56'>vt</a>                 56 test/api/gc-test.c   CuAssertIntEquals(T, "copied object not still PN_TUSER", ptr-&gt;vt, PN_TUSER);</span>
<span class='curline'><a href='../S/58.html#L111'>vt</a>                111 test/api/p2-test.c       CuAssert(T, "wrong type for allocated object", ((struct PNObject *)scanptr)-&gt;vt &lt;= PN_TUSER);</span>
<span class='curline'><a href='../S/54.html#L110'>vt</a>                110 test/api/potion-test.c       CuAssert(T, "wrong type for allocated object", ((struct PNObject *)scanptr)-&gt;vt &lt;= PN_TUSER);</span>
</pre>
</body>
</html>
